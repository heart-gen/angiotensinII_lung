2025-12-05 15:37:12 - **** Job starts ****
2025-12-05 15:37:12 - **** Bridges-2 info ****
User: kbenjamin
Job id: 36425945
Job name: airspace_denoising
Node name: 
Hostname: r183
Task id: N/A

Currently Loaded Modules:
  1) anaconda3/2024.10-1   2) gcc/13.3.1-p20240614

 

2025-12-05 15:37:13 - **** Loading mamba environment ****
2025-12-05 15:37:14 - **** Run analysis ****
2025-12-05 15:40:31,008 [INFO] Define masks
2025-12-05 15:40:31,049 [INFO] Subset data for training: perivascular
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-05 15:40:44,386 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 10 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [03:55<3:51:09, 235.08s/it]Epoch 1/60:   2%|▏         | 1/60 [03:55<3:51:09, 235.08s/it, v_num=1, train_loss_step=177, train_loss_epoch=503]Epoch 2/60:   2%|▏         | 1/60 [03:55<3:51:09, 235.08s/it, v_num=1, train_loss_step=177, train_loss_epoch=503]Epoch 2/60:   3%|▎         | 2/60 [07:27<3:34:37, 222.02s/it, v_num=1, train_loss_step=177, train_loss_epoch=503]Epoch 2/60:   3%|▎         | 2/60 [07:27<3:34:37, 222.02s/it, v_num=1, train_loss_step=536, train_loss_epoch=462]Epoch 3/60:   3%|▎         | 2/60 [07:27<3:34:37, 222.02s/it, v_num=1, train_loss_step=536, train_loss_epoch=462]Epoch 3/60:   5%|▌         | 3/60 [10:55<3:24:46, 215.54s/it, v_num=1, train_loss_step=536, train_loss_epoch=462]Epoch 3/60:   5%|▌         | 3/60 [10:55<3:24:46, 215.54s/it, v_num=1, train_loss_step=221, train_loss_epoch=454]Epoch 4/60:   5%|▌         | 3/60 [10:55<3:24:46, 215.54s/it, v_num=1, train_loss_step=221, train_loss_epoch=454]Epoch 4/60:   7%|▋         | 4/60 [14:06<3:12:01, 205.74s/it, v_num=1, train_loss_step=221, train_loss_epoch=454]Epoch 4/60:   7%|▋         | 4/60 [14:06<3:12:01, 205.74s/it, v_num=1, train_loss_step=438, train_loss_epoch=449]Epoch 5/60:   7%|▋         | 4/60 [14:06<3:12:01, 205.74s/it, v_num=1, train_loss_step=438, train_loss_epoch=449]Epoch 5/60:   8%|▊         | 5/60 [17:17<3:03:45, 200.47s/it, v_num=1, train_loss_step=438, train_loss_epoch=449]Epoch 5/60:   8%|▊         | 5/60 [17:17<3:03:45, 200.47s/it, v_num=1, train_loss_step=532, train_loss_epoch=447]Epoch 6/60:   8%|▊         | 5/60 [17:17<3:03:45, 200.47s/it, v_num=1, train_loss_step=532, train_loss_epoch=447]Epoch 6/60:  10%|█         | 6/60 [19:59<2:48:45, 187.50s/it, v_num=1, train_loss_step=532, train_loss_epoch=447]Epoch 6/60:  10%|█         | 6/60 [19:59<2:48:45, 187.50s/it, v_num=1, train_loss_step=338, train_loss_epoch=444]Epoch 7/60:  10%|█         | 6/60 [19:59<2:48:45, 187.50s/it, v_num=1, train_loss_step=338, train_loss_epoch=444]Epoch 7/60:  12%|█▏        | 7/60 [22:46<2:39:27, 180.52s/it, v_num=1, train_loss_step=338, train_loss_epoch=444]Epoch 7/60:  12%|█▏        | 7/60 [22:46<2:39:27, 180.52s/it, v_num=1, train_loss_step=171, train_loss_epoch=443]Epoch 8/60:  12%|█▏        | 7/60 [22:46<2:39:27, 180.52s/it, v_num=1, train_loss_step=171, train_loss_epoch=443]Epoch 8/60:  13%|█▎        | 8/60 [25:42<2:35:17, 179.18s/it, v_num=1, train_loss_step=171, train_loss_epoch=443]Epoch 8/60:  13%|█▎        | 8/60 [25:42<2:35:17, 179.18s/it, v_num=1, train_loss_step=257, train_loss_epoch=441]Epoch 9/60:  13%|█▎        | 8/60 [25:42<2:35:17, 179.18s/it, v_num=1, train_loss_step=257, train_loss_epoch=441]Epoch 9/60:  15%|█▌        | 9/60 [28:30<2:29:18, 175.66s/it, v_num=1, train_loss_step=257, train_loss_epoch=441]Epoch 9/60:  15%|█▌        | 9/60 [28:30<2:29:18, 175.66s/it, v_num=1, train_loss_step=426, train_loss_epoch=440]Epoch 10/60:  15%|█▌        | 9/60 [28:30<2:29:18, 175.66s/it, v_num=1, train_loss_step=426, train_loss_epoch=440]Epoch 10/60:  17%|█▋        | 10/60 [32:04<2:36:11, 187.44s/it, v_num=1, train_loss_step=426, train_loss_epoch=440]Epoch 10/60:  17%|█▋        | 10/60 [32:04<2:36:11, 187.44s/it, v_num=1, train_loss_step=411, train_loss_epoch=439]Epoch 11/60:  17%|█▋        | 10/60 [32:04<2:36:11, 187.44s/it, v_num=1, train_loss_step=411, train_loss_epoch=439]Epoch 11/60:  18%|█▊        | 11/60 [35:33<2:38:27, 194.03s/it, v_num=1, train_loss_step=411, train_loss_epoch=439]Epoch 11/60:  18%|█▊        | 11/60 [35:33<2:38:27, 194.03s/it, v_num=1, train_loss_step=340, train_loss_epoch=438]Epoch 12/60:  18%|█▊        | 11/60 [35:33<2:38:27, 194.03s/it, v_num=1, train_loss_step=340, train_loss_epoch=438]Epoch 12/60:  20%|██        | 12/60 [38:44<2:34:37, 193.29s/it, v_num=1, train_loss_step=340, train_loss_epoch=438]Epoch 12/60:  20%|██        | 12/60 [38:44<2:34:37, 193.29s/it, v_num=1, train_loss_step=282, train_loss_epoch=438]Epoch 13/60:  20%|██        | 12/60 [38:44<2:34:37, 193.29s/it, v_num=1, train_loss_step=282, train_loss_epoch=438]Epoch 13/60:  22%|██▏       | 13/60 [41:24<2:23:31, 183.21s/it, v_num=1, train_loss_step=282, train_loss_epoch=438]Epoch 13/60:  22%|██▏       | 13/60 [41:24<2:23:31, 183.21s/it, v_num=1, train_loss_step=316, train_loss_epoch=437]Epoch 14/60:  22%|██▏       | 13/60 [41:24<2:23:31, 183.21s/it, v_num=1, train_loss_step=316, train_loss_epoch=437]Epoch 14/60:  23%|██▎       | 14/60 [44:42<2:23:44, 187.49s/it, v_num=1, train_loss_step=316, train_loss_epoch=437]Epoch 14/60:  23%|██▎       | 14/60 [44:42<2:23:44, 187.49s/it, v_num=1, train_loss_step=40.5, train_loss_epoch=436]Epoch 15/60:  23%|██▎       | 14/60 [44:42<2:23:44, 187.49s/it, v_num=1, train_loss_step=40.5, train_loss_epoch=436]Epoch 15/60:  25%|██▌       | 15/60 [47:46<2:20:00, 186.67s/it, v_num=1, train_loss_step=40.5, train_loss_epoch=436]Epoch 15/60:  25%|██▌       | 15/60 [47:46<2:20:00, 186.67s/it, v_num=1, train_loss_step=446, train_loss_epoch=436] Epoch 16/60:  25%|██▌       | 15/60 [47:46<2:20:00, 186.67s/it, v_num=1, train_loss_step=446, train_loss_epoch=436]Epoch 16/60:  27%|██▋       | 16/60 [51:38<2:26:44, 200.10s/it, v_num=1, train_loss_step=446, train_loss_epoch=436]Epoch 16/60:  27%|██▋       | 16/60 [51:38<2:26:44, 200.10s/it, v_num=1, train_loss_step=471, train_loss_epoch=436]Epoch 17/60:  27%|██▋       | 16/60 [51:38<2:26:44, 200.10s/it, v_num=1, train_loss_step=471, train_loss_epoch=436]Epoch 17/60:  28%|██▊       | 17/60 [54:20<2:15:17, 188.79s/it, v_num=1, train_loss_step=471, train_loss_epoch=436]Epoch 17/60:  28%|██▊       | 17/60 [54:20<2:15:17, 188.79s/it, v_num=1, train_loss_step=218, train_loss_epoch=435]Epoch 18/60:  28%|██▊       | 17/60 [54:20<2:15:17, 188.79s/it, v_num=1, train_loss_step=218, train_loss_epoch=435]Epoch 18/60:  30%|███       | 18/60 [57:28<2:11:51, 188.36s/it, v_num=1, train_loss_step=218, train_loss_epoch=435]Epoch 18/60:  30%|███       | 18/60 [57:28<2:11:51, 188.36s/it, v_num=1, train_loss_step=219, train_loss_epoch=435]Epoch 19/60:  30%|███       | 18/60 [57:28<2:11:51, 188.36s/it, v_num=1, train_loss_step=219, train_loss_epoch=435]Epoch 19/60:  32%|███▏      | 19/60 [1:00:47<2:10:58, 191.66s/it, v_num=1, train_loss_step=219, train_loss_epoch=435]Epoch 19/60:  32%|███▏      | 19/60 [1:00:47<2:10:58, 191.66s/it, v_num=1, train_loss_step=284, train_loss_epoch=435]Epoch 20/60:  32%|███▏      | 19/60 [1:00:47<2:10:58, 191.66s/it, v_num=1, train_loss_step=284, train_loss_epoch=435]Epoch 20/60:  33%|███▎      | 20/60 [1:04:17<2:11:22, 197.07s/it, v_num=1, train_loss_step=284, train_loss_epoch=435]Epoch 20/60:  33%|███▎      | 20/60 [1:04:17<2:11:22, 197.07s/it, v_num=1, train_loss_step=300, train_loss_epoch=434]Epoch 21/60:  33%|███▎      | 20/60 [1:04:17<2:11:22, 197.07s/it, v_num=1, train_loss_step=300, train_loss_epoch=434]Epoch 21/60:  35%|███▌      | 21/60 [1:07:55<2:12:17, 203.54s/it, v_num=1, train_loss_step=300, train_loss_epoch=434]Epoch 21/60:  35%|███▌      | 21/60 [1:07:55<2:12:17, 203.54s/it, v_num=1, train_loss_step=391, train_loss_epoch=434]Epoch 22/60:  35%|███▌      | 21/60 [1:07:55<2:12:17, 203.54s/it, v_num=1, train_loss_step=391, train_loss_epoch=434]Epoch 22/60:  37%|███▋      | 22/60 [1:11:26<2:10:18, 205.74s/it, v_num=1, train_loss_step=391, train_loss_epoch=434]Epoch 22/60:  37%|███▋      | 22/60 [1:11:26<2:10:18, 205.74s/it, v_num=1, train_loss_step=424, train_loss_epoch=434]Epoch 23/60:  37%|███▋      | 22/60 [1:11:26<2:10:18, 205.74s/it, v_num=1, train_loss_step=424, train_loss_epoch=434]Epoch 23/60:  38%|███▊      | 23/60 [1:14:28<2:02:32, 198.72s/it, v_num=1, train_loss_step=424, train_loss_epoch=434]Epoch 23/60:  38%|███▊      | 23/60 [1:14:28<2:02:32, 198.72s/it, v_num=1, train_loss_step=510, train_loss_epoch=434]Epoch 24/60:  38%|███▊      | 23/60 [1:14:28<2:02:32, 198.72s/it, v_num=1, train_loss_step=510, train_loss_epoch=434]Epoch 24/60:  40%|████      | 24/60 [1:17:28<1:55:49, 193.04s/it, v_num=1, train_loss_step=510, train_loss_epoch=434]Epoch 24/60:  40%|████      | 24/60 [1:17:28<1:55:49, 193.04s/it, v_num=1, train_loss_step=600, train_loss_epoch=433]Epoch 25/60:  40%|████      | 24/60 [1:17:28<1:55:49, 193.04s/it, v_num=1, train_loss_step=600, train_loss_epoch=433]Epoch 25/60:  42%|████▏     | 25/60 [1:20:46<1:53:22, 194.37s/it, v_num=1, train_loss_step=600, train_loss_epoch=433]Epoch 25/60:  42%|████▏     | 25/60 [1:20:46<1:53:22, 194.37s/it, v_num=1, train_loss_step=423, train_loss_epoch=433]Epoch 26/60:  42%|████▏     | 25/60 [1:20:46<1:53:22, 194.37s/it, v_num=1, train_loss_step=423, train_loss_epoch=433]Epoch 26/60:  43%|████▎     | 26/60 [1:24:31<1:55:23, 203.64s/it, v_num=1, train_loss_step=423, train_loss_epoch=433]Epoch 26/60:  43%|████▎     | 26/60 [1:24:31<1:55:23, 203.64s/it, v_num=1, train_loss_step=535, train_loss_epoch=433]Epoch 27/60:  43%|████▎     | 26/60 [1:24:31<1:55:23, 203.64s/it, v_num=1, train_loss_step=535, train_loss_epoch=433]Epoch 27/60:  45%|████▌     | 27/60 [1:27:35<1:48:42, 197.64s/it, v_num=1, train_loss_step=535, train_loss_epoch=433]Epoch 27/60:  45%|████▌     | 27/60 [1:27:35<1:48:42, 197.64s/it, v_num=1, train_loss_step=438, train_loss_epoch=433]Epoch 28/60:  45%|████▌     | 27/60 [1:27:35<1:48:42, 197.64s/it, v_num=1, train_loss_step=438, train_loss_epoch=433]Epoch 28/60:  47%|████▋     | 28/60 [1:30:56<1:46:00, 198.77s/it, v_num=1, train_loss_step=438, train_loss_epoch=433]Epoch 28/60:  47%|████▋     | 28/60 [1:30:56<1:46:00, 198.77s/it, v_num=1, train_loss_step=736, train_loss_epoch=432]Epoch 29/60:  47%|████▋     | 28/60 [1:30:56<1:46:00, 198.77s/it, v_num=1, train_loss_step=736, train_loss_epoch=432]Epoch 29/60:  48%|████▊     | 29/60 [1:34:00<1:40:21, 194.25s/it, v_num=1, train_loss_step=736, train_loss_epoch=432]Epoch 29/60:  48%|████▊     | 29/60 [1:34:00<1:40:21, 194.25s/it, v_num=1, train_loss_step=398, train_loss_epoch=432]Epoch 30/60:  48%|████▊     | 29/60 [1:34:00<1:40:21, 194.25s/it, v_num=1, train_loss_step=398, train_loss_epoch=432]Epoch 30/60:  50%|█████     | 30/60 [1:37:20<1:37:58, 195.96s/it, v_num=1, train_loss_step=398, train_loss_epoch=432]Epoch 30/60:  50%|█████     | 30/60 [1:37:20<1:37:58, 195.96s/it, v_num=1, train_loss_step=534, train_loss_epoch=432]Epoch 31/60:  50%|█████     | 30/60 [1:37:20<1:37:58, 195.96s/it, v_num=1, train_loss_step=534, train_loss_epoch=432]Epoch 31/60:  52%|█████▏    | 31/60 [1:40:11<1:31:11, 188.66s/it, v_num=1, train_loss_step=534, train_loss_epoch=432]Epoch 31/60:  52%|█████▏    | 31/60 [1:40:11<1:31:11, 188.66s/it, v_num=1, train_loss_step=744, train_loss_epoch=432]Epoch 32/60:  52%|█████▏    | 31/60 [1:40:11<1:31:11, 188.66s/it, v_num=1, train_loss_step=744, train_loss_epoch=432]Epoch 32/60:  53%|█████▎    | 32/60 [1:43:38<1:30:32, 194.03s/it, v_num=1, train_loss_step=744, train_loss_epoch=432]Epoch 32/60:  53%|█████▎    | 32/60 [1:43:38<1:30:32, 194.03s/it, v_num=1, train_loss_step=507, train_loss_epoch=432]Epoch 33/60:  53%|█████▎    | 32/60 [1:43:38<1:30:32, 194.03s/it, v_num=1, train_loss_step=507, train_loss_epoch=432]Epoch 33/60:  55%|█████▌    | 33/60 [1:46:36<1:25:07, 189.16s/it, v_num=1, train_loss_step=507, train_loss_epoch=432]Epoch 33/60:  55%|█████▌    | 33/60 [1:46:36<1:25:07, 189.16s/it, v_num=1, train_loss_step=370, train_loss_epoch=432]Epoch 34/60:  55%|█████▌    | 33/60 [1:46:36<1:25:07, 189.16s/it, v_num=1, train_loss_step=370, train_loss_epoch=432]Epoch 34/60:  57%|█████▋    | 34/60 [1:49:53<1:23:02, 191.65s/it, v_num=1, train_loss_step=370, train_loss_epoch=432]Epoch 34/60:  57%|█████▋    | 34/60 [1:49:53<1:23:02, 191.65s/it, v_num=1, train_loss_step=470, train_loss_epoch=432]Epoch 35/60:  57%|█████▋    | 34/60 [1:49:53<1:23:02, 191.65s/it, v_num=1, train_loss_step=470, train_loss_epoch=432]Epoch 35/60:  58%|█████▊    | 35/60 [1:52:15<1:13:36, 176.66s/it, v_num=1, train_loss_step=470, train_loss_epoch=432]Epoch 35/60:  58%|█████▊    | 35/60 [1:52:15<1:13:36, 176.66s/it, v_num=1, train_loss_step=271, train_loss_epoch=432]Epoch 36/60:  58%|█████▊    | 35/60 [1:52:15<1:13:36, 176.66s/it, v_num=1, train_loss_step=271, train_loss_epoch=432]Epoch 36/60:  60%|██████    | 36/60 [1:54:30<1:05:40, 164.17s/it, v_num=1, train_loss_step=271, train_loss_epoch=432]Epoch 36/60:  60%|██████    | 36/60 [1:54:30<1:05:40, 164.17s/it, v_num=1, train_loss_step=42.8, train_loss_epoch=431]Epoch 37/60:  60%|██████    | 36/60 [1:54:30<1:05:40, 164.17s/it, v_num=1, train_loss_step=42.8, train_loss_epoch=431]Epoch 37/60:  62%|██████▏   | 37/60 [1:56:47<59:52, 156.19s/it, v_num=1, train_loss_step=42.8, train_loss_epoch=431]  Epoch 37/60:  62%|██████▏   | 37/60 [1:56:47<59:52, 156.19s/it, v_num=1, train_loss_step=470, train_loss_epoch=431] Epoch 38/60:  62%|██████▏   | 37/60 [1:56:47<59:52, 156.19s/it, v_num=1, train_loss_step=470, train_loss_epoch=431]Epoch 38/60:  63%|██████▎   | 38/60 [1:59:34<58:27, 159.44s/it, v_num=1, train_loss_step=470, train_loss_epoch=431]Epoch 38/60:  63%|██████▎   | 38/60 [1:59:34<58:27, 159.44s/it, v_num=1, train_loss_step=145, train_loss_epoch=431]Epoch 39/60:  63%|██████▎   | 38/60 [1:59:34<58:27, 159.44s/it, v_num=1, train_loss_step=145, train_loss_epoch=431]Epoch 39/60:  65%|██████▌   | 39/60 [2:02:35<58:02, 165.84s/it, v_num=1, train_loss_step=145, train_loss_epoch=431]Epoch 39/60:  65%|██████▌   | 39/60 [2:02:35<58:02, 165.84s/it, v_num=1, train_loss_step=455, train_loss_epoch=431]Epoch 40/60:  65%|██████▌   | 39/60 [2:02:35<58:02, 165.84s/it, v_num=1, train_loss_step=455, train_loss_epoch=431]Epoch 40/60:  67%|██████▋   | 40/60 [2:05:24<55:34, 166.70s/it, v_num=1, train_loss_step=455, train_loss_epoch=431]Epoch 40/60:  67%|██████▋   | 40/60 [2:05:24<55:34, 166.70s/it, v_num=1, train_loss_step=246, train_loss_epoch=431]Epoch 41/60:  67%|██████▋   | 40/60 [2:05:24<55:34, 166.70s/it, v_num=1, train_loss_step=246, train_loss_epoch=431]Epoch 41/60:  68%|██████▊   | 41/60 [2:08:23<53:59, 170.50s/it, v_num=1, train_loss_step=246, train_loss_epoch=431]Epoch 41/60:  68%|██████▊   | 41/60 [2:08:23<53:59, 170.50s/it, v_num=1, train_loss_step=559, train_loss_epoch=431]Epoch 42/60:  68%|██████▊   | 41/60 [2:08:23<53:59, 170.50s/it, v_num=1, train_loss_step=559, train_loss_epoch=431]Epoch 42/60:  70%|███████   | 42/60 [2:11:35<53:02, 176.82s/it, v_num=1, train_loss_step=559, train_loss_epoch=431]Epoch 42/60:  70%|███████   | 42/60 [2:11:35<53:02, 176.82s/it, v_num=1, train_loss_step=370, train_loss_epoch=431]Epoch 43/60:  70%|███████   | 42/60 [2:11:35<53:02, 176.82s/it, v_num=1, train_loss_step=370, train_loss_epoch=431]Epoch 43/60:  72%|███████▏  | 43/60 [2:14:15<48:41, 171.87s/it, v_num=1, train_loss_step=370, train_loss_epoch=431]Epoch 43/60:  72%|███████▏  | 43/60 [2:14:15<48:41, 171.87s/it, v_num=1, train_loss_step=556, train_loss_epoch=431]Epoch 44/60:  72%|███████▏  | 43/60 [2:14:15<48:41, 171.87s/it, v_num=1, train_loss_step=556, train_loss_epoch=431]Epoch 44/60:  73%|███████▎  | 44/60 [2:17:03<45:31, 170.71s/it, v_num=1, train_loss_step=556, train_loss_epoch=431]Epoch 44/60:  73%|███████▎  | 44/60 [2:17:03<45:31, 170.71s/it, v_num=1, train_loss_step=541, train_loss_epoch=431]Epoch 45/60:  73%|███████▎  | 44/60 [2:17:03<45:31, 170.71s/it, v_num=1, train_loss_step=541, train_loss_epoch=431]Epoch 45/60:  75%|███████▌  | 45/60 [2:20:12<44:03, 176.25s/it, v_num=1, train_loss_step=541, train_loss_epoch=431]Epoch 45/60:  75%|███████▌  | 45/60 [2:20:12<44:03, 176.25s/it, v_num=1, train_loss_step=0.0294, train_loss_epoch=431]Epoch 46/60:  75%|███████▌  | 45/60 [2:20:12<44:03, 176.25s/it, v_num=1, train_loss_step=0.0294, train_loss_epoch=431]Epoch 46/60:  77%|███████▋  | 46/60 [2:23:24<42:10, 180.78s/it, v_num=1, train_loss_step=0.0294, train_loss_epoch=431]Epoch 46/60:  77%|███████▋  | 46/60 [2:23:24<42:10, 180.78s/it, v_num=1, train_loss_step=529, train_loss_epoch=430]   Epoch 47/60:  77%|███████▋  | 46/60 [2:23:24<42:10, 180.78s/it, v_num=1, train_loss_step=529, train_loss_epoch=430]Epoch 47/60:  78%|███████▊  | 47/60 [2:26:14<38:28, 177.60s/it, v_num=1, train_loss_step=529, train_loss_epoch=430]Epoch 47/60:  78%|███████▊  | 47/60 [2:26:14<38:28, 177.60s/it, v_num=1, train_loss_step=248, train_loss_epoch=430]Epoch 48/60:  78%|███████▊  | 47/60 [2:26:14<38:28, 177.60s/it, v_num=1, train_loss_step=248, train_loss_epoch=430]Epoch 48/60:  80%|████████  | 48/60 [2:29:34<36:52, 184.39s/it, v_num=1, train_loss_step=248, train_loss_epoch=430]Epoch 48/60:  80%|████████  | 48/60 [2:29:34<36:52, 184.39s/it, v_num=1, train_loss_step=345, train_loss_epoch=430]Epoch 49/60:  80%|████████  | 48/60 [2:29:34<36:52, 184.39s/it, v_num=1, train_loss_step=345, train_loss_epoch=430]Epoch 49/60:  82%|████████▏ | 49/60 [2:32:19<32:43, 178.51s/it, v_num=1, train_loss_step=345, train_loss_epoch=430]Epoch 49/60:  82%|████████▏ | 49/60 [2:32:19<32:43, 178.51s/it, v_num=1, train_loss_step=818, train_loss_epoch=430]Epoch 50/60:  82%|████████▏ | 49/60 [2:32:19<32:43, 178.51s/it, v_num=1, train_loss_step=818, train_loss_epoch=430]Epoch 50/60:  83%|████████▎ | 50/60 [2:35:41<30:54, 185.48s/it, v_num=1, train_loss_step=818, train_loss_epoch=430]Epoch 50/60:  83%|████████▎ | 50/60 [2:35:41<30:54, 185.48s/it, v_num=1, train_loss_step=823, train_loss_epoch=430]Epoch 51/60:  83%|████████▎ | 50/60 [2:35:41<30:54, 185.48s/it, v_num=1, train_loss_step=823, train_loss_epoch=430]Epoch 51/60:  85%|████████▌ | 51/60 [2:38:39<27:30, 183.43s/it, v_num=1, train_loss_step=823, train_loss_epoch=430]Epoch 51/60:  85%|████████▌ | 51/60 [2:38:39<27:30, 183.43s/it, v_num=1, train_loss_step=284, train_loss_epoch=430]Epoch 52/60:  85%|████████▌ | 51/60 [2:38:39<27:30, 183.43s/it, v_num=1, train_loss_step=284, train_loss_epoch=430]Epoch 52/60:  87%|████████▋ | 52/60 [2:42:17<25:49, 193.70s/it, v_num=1, train_loss_step=284, train_loss_epoch=430]Epoch 52/60:  87%|████████▋ | 52/60 [2:42:17<25:49, 193.70s/it, v_num=1, train_loss_step=186, train_loss_epoch=430]Epoch 53/60:  87%|████████▋ | 52/60 [2:42:17<25:49, 193.70s/it, v_num=1, train_loss_step=186, train_loss_epoch=430]Epoch 53/60:  88%|████████▊ | 53/60 [2:46:02<23:42, 203.18s/it, v_num=1, train_loss_step=186, train_loss_epoch=430]Epoch 53/60:  88%|████████▊ | 53/60 [2:46:02<23:42, 203.18s/it, v_num=1, train_loss_step=425, train_loss_epoch=430]Epoch 54/60:  88%|████████▊ | 53/60 [2:46:02<23:42, 203.18s/it, v_num=1, train_loss_step=425, train_loss_epoch=430]Epoch 54/60:  90%|█████████ | 54/60 [2:49:44<20:52, 208.81s/it, v_num=1, train_loss_step=425, train_loss_epoch=430]Epoch 54/60:  90%|█████████ | 54/60 [2:49:44<20:52, 208.81s/it, v_num=1, train_loss_step=575, train_loss_epoch=430]Epoch 55/60:  90%|█████████ | 54/60 [2:49:44<20:52, 208.81s/it, v_num=1, train_loss_step=575, train_loss_epoch=430]Epoch 55/60:  92%|█████████▏| 55/60 [2:53:01<17:06, 205.23s/it, v_num=1, train_loss_step=575, train_loss_epoch=430]Epoch 55/60:  92%|█████████▏| 55/60 [2:53:01<17:06, 205.23s/it, v_num=1, train_loss_step=210, train_loss_epoch=430]Epoch 56/60:  92%|█████████▏| 55/60 [2:53:01<17:06, 205.23s/it, v_num=1, train_loss_step=210, train_loss_epoch=430]Epoch 56/60:  93%|█████████▎| 56/60 [2:56:19<13:31, 202.92s/it, v_num=1, train_loss_step=210, train_loss_epoch=430]Epoch 56/60:  93%|█████████▎| 56/60 [2:56:19<13:31, 202.92s/it, v_num=1, train_loss_step=523, train_loss_epoch=430]Epoch 57/60:  93%|█████████▎| 56/60 [2:56:19<13:31, 202.92s/it, v_num=1, train_loss_step=523, train_loss_epoch=430]Epoch 57/60:  95%|█████████▌| 57/60 [2:59:11<09:41, 193.76s/it, v_num=1, train_loss_step=523, train_loss_epoch=430]Epoch 57/60:  95%|█████████▌| 57/60 [2:59:11<09:41, 193.76s/it, v_num=1, train_loss_step=86.1, train_loss_epoch=430]Epoch 58/60:  95%|█████████▌| 57/60 [2:59:11<09:41, 193.76s/it, v_num=1, train_loss_step=86.1, train_loss_epoch=430]Epoch 58/60:  97%|█████████▋| 58/60 [3:02:06<06:16, 188.25s/it, v_num=1, train_loss_step=86.1, train_loss_epoch=430]Epoch 58/60:  97%|█████████▋| 58/60 [3:02:06<06:16, 188.25s/it, v_num=1, train_loss_step=487, train_loss_epoch=430] Epoch 59/60:  97%|█████████▋| 58/60 [3:02:06<06:16, 188.25s/it, v_num=1, train_loss_step=487, train_loss_epoch=430]Epoch 59/60:  98%|█████████▊| 59/60 [3:05:34<03:14, 194.19s/it, v_num=1, train_loss_step=487, train_loss_epoch=430]Epoch 59/60:  98%|█████████▊| 59/60 [3:05:34<03:14, 194.19s/it, v_num=1, train_loss_step=307, train_loss_epoch=430]Epoch 60/60:  98%|█████████▊| 59/60 [3:05:34<03:14, 194.19s/it, v_num=1, train_loss_step=307, train_loss_epoch=430]Epoch 60/60: 100%|██████████| 60/60 [3:08:59<00:00, 197.18s/it, v_num=1, train_loss_step=307, train_loss_epoch=430]Epoch 60/60: 100%|██████████| 60/60 [3:08:59<00:00, 197.18s/it, v_num=1, train_loss_step=219, train_loss_epoch=430]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [3:08:59<00:00, 188.99s/it, v_num=1, train_loss_step=219, train_loss_epoch=430]2025-12-05 18:51:44,376 [INFO] Subset data for training: pericytes
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-05 18:51:48,974 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 4 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.

Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [00:24<23:51, 24.27s/it]Epoch 1/60:   2%|▏         | 1/60 [00:24<23:51, 24.27s/it, v_num=1, train_loss_step=526, train_loss_epoch=461]Epoch 2/60:   2%|▏         | 1/60 [00:24<23:51, 24.27s/it, v_num=1, train_loss_step=526, train_loss_epoch=461]Epoch 2/60:   3%|▎         | 2/60 [00:38<17:40, 18.28s/it, v_num=1, train_loss_step=526, train_loss_epoch=461]Epoch 2/60:   3%|▎         | 2/60 [00:38<17:40, 18.28s/it, v_num=1, train_loss_step=290, train_loss_epoch=345]Epoch 3/60:   3%|▎         | 2/60 [00:38<17:40, 18.28s/it, v_num=1, train_loss_step=290, train_loss_epoch=345]Epoch 3/60:   5%|▌         | 3/60 [00:52<15:36, 16.43s/it, v_num=1, train_loss_step=290, train_loss_epoch=345]Epoch 3/60:   5%|▌         | 3/60 [00:52<15:36, 16.43s/it, v_num=1, train_loss_step=371, train_loss_epoch=337]Epoch 4/60:   5%|▌         | 3/60 [00:52<15:36, 16.43s/it, v_num=1, train_loss_step=371, train_loss_epoch=337]Epoch 4/60:   7%|▋         | 4/60 [01:07<14:45, 15.81s/it, v_num=1, train_loss_step=371, train_loss_epoch=337]Epoch 4/60:   7%|▋         | 4/60 [01:07<14:45, 15.81s/it, v_num=1, train_loss_step=314, train_loss_epoch=334]Epoch 5/60:   7%|▋         | 4/60 [01:07<14:45, 15.81s/it, v_num=1, train_loss_step=314, train_loss_epoch=334]Epoch 5/60:   8%|▊         | 5/60 [01:24<14:47, 16.14s/it, v_num=1, train_loss_step=314, train_loss_epoch=334]Epoch 5/60:   8%|▊         | 5/60 [01:24<14:47, 16.14s/it, v_num=1, train_loss_step=817, train_loss_epoch=330]Epoch 6/60:   8%|▊         | 5/60 [01:24<14:47, 16.14s/it, v_num=1, train_loss_step=817, train_loss_epoch=330]Epoch 6/60:  10%|█         | 6/60 [01:38<13:55, 15.48s/it, v_num=1, train_loss_step=817, train_loss_epoch=330]Epoch 6/60:  10%|█         | 6/60 [01:38<13:55, 15.48s/it, v_num=1, train_loss_step=943, train_loss_epoch=329]Epoch 7/60:  10%|█         | 6/60 [01:38<13:55, 15.48s/it, v_num=1, train_loss_step=943, train_loss_epoch=329]Epoch 7/60:  12%|█▏        | 7/60 [02:03<16:24, 18.58s/it, v_num=1, train_loss_step=943, train_loss_epoch=329]Epoch 7/60:  12%|█▏        | 7/60 [02:03<16:24, 18.58s/it, v_num=1, train_loss_step=449, train_loss_epoch=327]Epoch 8/60:  12%|█▏        | 7/60 [02:03<16:24, 18.58s/it, v_num=1, train_loss_step=449, train_loss_epoch=327]Epoch 8/60:  13%|█▎        | 8/60 [02:17<14:59, 17.31s/it, v_num=1, train_loss_step=449, train_loss_epoch=327]Epoch 8/60:  13%|█▎        | 8/60 [02:17<14:59, 17.31s/it, v_num=1, train_loss_step=428, train_loss_epoch=325]Epoch 9/60:  13%|█▎        | 8/60 [02:17<14:59, 17.31s/it, v_num=1, train_loss_step=428, train_loss_epoch=325]Epoch 9/60:  15%|█▌        | 9/60 [02:33<14:12, 16.72s/it, v_num=1, train_loss_step=428, train_loss_epoch=325]Epoch 9/60:  15%|█▌        | 9/60 [02:33<14:12, 16.72s/it, v_num=1, train_loss_step=536, train_loss_epoch=324]Epoch 10/60:  15%|█▌        | 9/60 [02:33<14:12, 16.72s/it, v_num=1, train_loss_step=536, train_loss_epoch=324]Epoch 10/60:  17%|█▋        | 10/60 [02:48<13:27, 16.16s/it, v_num=1, train_loss_step=536, train_loss_epoch=324]Epoch 10/60:  17%|█▋        | 10/60 [02:48<13:27, 16.16s/it, v_num=1, train_loss_step=351, train_loss_epoch=323]Epoch 11/60:  17%|█▋        | 10/60 [02:48<13:27, 16.16s/it, v_num=1, train_loss_step=351, train_loss_epoch=323]Epoch 11/60:  18%|█▊        | 11/60 [03:02<12:36, 15.45s/it, v_num=1, train_loss_step=351, train_loss_epoch=323]Epoch 11/60:  18%|█▊        | 11/60 [03:02<12:36, 15.45s/it, v_num=1, train_loss_step=211, train_loss_epoch=322]Epoch 12/60:  18%|█▊        | 11/60 [03:02<12:36, 15.45s/it, v_num=1, train_loss_step=211, train_loss_epoch=322]Epoch 12/60:  20%|██        | 12/60 [03:19<12:45, 15.94s/it, v_num=1, train_loss_step=211, train_loss_epoch=322]Epoch 12/60:  20%|██        | 12/60 [03:19<12:45, 15.94s/it, v_num=1, train_loss_step=381, train_loss_epoch=321]Epoch 13/60:  20%|██        | 12/60 [03:19<12:45, 15.94s/it, v_num=1, train_loss_step=381, train_loss_epoch=321]Epoch 13/60:  22%|██▏       | 13/60 [03:38<13:16, 16.95s/it, v_num=1, train_loss_step=381, train_loss_epoch=321]Epoch 13/60:  22%|██▏       | 13/60 [03:38<13:16, 16.95s/it, v_num=1, train_loss_step=167, train_loss_epoch=321]Epoch 14/60:  22%|██▏       | 13/60 [03:38<13:16, 16.95s/it, v_num=1, train_loss_step=167, train_loss_epoch=321]Epoch 14/60:  23%|██▎       | 14/60 [03:54<12:45, 16.64s/it, v_num=1, train_loss_step=167, train_loss_epoch=321]Epoch 14/60:  23%|██▎       | 14/60 [03:54<12:45, 16.64s/it, v_num=1, train_loss_step=824, train_loss_epoch=320]Epoch 15/60:  23%|██▎       | 14/60 [03:54<12:45, 16.64s/it, v_num=1, train_loss_step=824, train_loss_epoch=320]Epoch 15/60:  25%|██▌       | 15/60 [04:16<13:46, 18.36s/it, v_num=1, train_loss_step=824, train_loss_epoch=320]Epoch 15/60:  25%|██▌       | 15/60 [04:16<13:46, 18.36s/it, v_num=1, train_loss_step=92.7, train_loss_epoch=319]Epoch 16/60:  25%|██▌       | 15/60 [04:16<13:46, 18.36s/it, v_num=1, train_loss_step=92.7, train_loss_epoch=319]Epoch 16/60:  27%|██▋       | 16/60 [04:33<13:08, 17.92s/it, v_num=1, train_loss_step=92.7, train_loss_epoch=319]Epoch 16/60:  27%|██▋       | 16/60 [04:33<13:08, 17.92s/it, v_num=1, train_loss_step=221, train_loss_epoch=319] Epoch 17/60:  27%|██▋       | 16/60 [04:33<13:08, 17.92s/it, v_num=1, train_loss_step=221, train_loss_epoch=319]Epoch 17/60:  28%|██▊       | 17/60 [04:51<12:52, 17.97s/it, v_num=1, train_loss_step=221, train_loss_epoch=319]Epoch 17/60:  28%|██▊       | 17/60 [04:51<12:52, 17.97s/it, v_num=1, train_loss_step=0.135, train_loss_epoch=318]Epoch 18/60:  28%|██▊       | 17/60 [04:51<12:52, 17.97s/it, v_num=1, train_loss_step=0.135, train_loss_epoch=318]Epoch 18/60:  30%|███       | 18/60 [05:09<12:35, 17.99s/it, v_num=1, train_loss_step=0.135, train_loss_epoch=318]Epoch 18/60:  30%|███       | 18/60 [05:09<12:35, 17.99s/it, v_num=1, train_loss_step=361, train_loss_epoch=318]  Epoch 19/60:  30%|███       | 18/60 [05:09<12:35, 17.99s/it, v_num=1, train_loss_step=361, train_loss_epoch=318]Epoch 19/60:  32%|███▏      | 19/60 [05:26<12:00, 17.57s/it, v_num=1, train_loss_step=361, train_loss_epoch=318]Epoch 19/60:  32%|███▏      | 19/60 [05:26<12:00, 17.57s/it, v_num=1, train_loss_step=243, train_loss_epoch=317]Epoch 20/60:  32%|███▏      | 19/60 [05:26<12:00, 17.57s/it, v_num=1, train_loss_step=243, train_loss_epoch=317]Epoch 20/60:  33%|███▎      | 20/60 [05:38<10:33, 15.84s/it, v_num=1, train_loss_step=243, train_loss_epoch=317]Epoch 20/60:  33%|███▎      | 20/60 [05:38<10:33, 15.84s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 21/60:  33%|███▎      | 20/60 [05:38<10:33, 15.84s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 21/60:  35%|███▌      | 21/60 [05:52<09:59, 15.38s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 21/60:  35%|███▌      | 21/60 [05:52<09:59, 15.38s/it, v_num=1, train_loss_step=405, train_loss_epoch=316]Epoch 22/60:  35%|███▌      | 21/60 [05:52<09:59, 15.38s/it, v_num=1, train_loss_step=405, train_loss_epoch=316]Epoch 22/60:  37%|███▋      | 22/60 [06:10<10:12, 16.11s/it, v_num=1, train_loss_step=405, train_loss_epoch=316]Epoch 22/60:  37%|███▋      | 22/60 [06:10<10:12, 16.11s/it, v_num=1, train_loss_step=74.6, train_loss_epoch=316]Epoch 23/60:  37%|███▋      | 22/60 [06:10<10:12, 16.11s/it, v_num=1, train_loss_step=74.6, train_loss_epoch=316]Epoch 23/60:  38%|███▊      | 23/60 [06:27<10:09, 16.47s/it, v_num=1, train_loss_step=74.6, train_loss_epoch=316]Epoch 23/60:  38%|███▊      | 23/60 [06:27<10:09, 16.47s/it, v_num=1, train_loss_step=571, train_loss_epoch=315] Epoch 24/60:  38%|███▊      | 23/60 [06:27<10:09, 16.47s/it, v_num=1, train_loss_step=571, train_loss_epoch=315]Epoch 24/60:  40%|████      | 24/60 [06:40<09:19, 15.54s/it, v_num=1, train_loss_step=571, train_loss_epoch=315]Epoch 24/60:  40%|████      | 24/60 [06:40<09:19, 15.54s/it, v_num=1, train_loss_step=773, train_loss_epoch=315]Epoch 25/60:  40%|████      | 24/60 [06:40<09:19, 15.54s/it, v_num=1, train_loss_step=773, train_loss_epoch=315]Epoch 25/60:  42%|████▏     | 25/60 [07:01<09:55, 17.02s/it, v_num=1, train_loss_step=773, train_loss_epoch=315]Epoch 25/60:  42%|████▏     | 25/60 [07:01<09:55, 17.02s/it, v_num=1, train_loss_step=895, train_loss_epoch=315]Epoch 26/60:  42%|████▏     | 25/60 [07:01<09:55, 17.02s/it, v_num=1, train_loss_step=895, train_loss_epoch=315]Epoch 26/60:  43%|████▎     | 26/60 [07:18<09:35, 16.93s/it, v_num=1, train_loss_step=895, train_loss_epoch=315]Epoch 26/60:  43%|████▎     | 26/60 [07:18<09:35, 16.93s/it, v_num=1, train_loss_step=69.9, train_loss_epoch=315]Epoch 27/60:  43%|████▎     | 26/60 [07:18<09:35, 16.93s/it, v_num=1, train_loss_step=69.9, train_loss_epoch=315]Epoch 27/60:  45%|████▌     | 27/60 [07:38<09:49, 17.88s/it, v_num=1, train_loss_step=69.9, train_loss_epoch=315]Epoch 27/60:  45%|████▌     | 27/60 [07:38<09:49, 17.88s/it, v_num=1, train_loss_step=503, train_loss_epoch=314] Epoch 28/60:  45%|████▌     | 27/60 [07:38<09:49, 17.88s/it, v_num=1, train_loss_step=503, train_loss_epoch=314]Epoch 28/60:  47%|████▋     | 28/60 [07:59<10:01, 18.81s/it, v_num=1, train_loss_step=503, train_loss_epoch=314]Epoch 28/60:  47%|████▋     | 28/60 [07:59<10:01, 18.81s/it, v_num=1, train_loss_step=185, train_loss_epoch=314]Epoch 29/60:  47%|████▋     | 28/60 [07:59<10:01, 18.81s/it, v_num=1, train_loss_step=185, train_loss_epoch=314]Epoch 29/60:  48%|████▊     | 29/60 [08:13<09:00, 17.45s/it, v_num=1, train_loss_step=185, train_loss_epoch=314]Epoch 29/60:  48%|████▊     | 29/60 [08:13<09:00, 17.45s/it, v_num=1, train_loss_step=0.37, train_loss_epoch=313]Epoch 30/60:  48%|████▊     | 29/60 [08:13<09:00, 17.45s/it, v_num=1, train_loss_step=0.37, train_loss_epoch=313]Epoch 30/60:  50%|█████     | 30/60 [08:25<07:55, 15.86s/it, v_num=1, train_loss_step=0.37, train_loss_epoch=313]Epoch 30/60:  50%|█████     | 30/60 [08:25<07:55, 15.86s/it, v_num=1, train_loss_step=494, train_loss_epoch=313] Epoch 31/60:  50%|█████     | 30/60 [08:25<07:55, 15.86s/it, v_num=1, train_loss_step=494, train_loss_epoch=313]Epoch 31/60:  52%|█████▏    | 31/60 [08:45<08:12, 17.00s/it, v_num=1, train_loss_step=494, train_loss_epoch=313]Epoch 31/60:  52%|█████▏    | 31/60 [08:45<08:12, 17.00s/it, v_num=1, train_loss_step=185, train_loss_epoch=313]Epoch 32/60:  52%|█████▏    | 31/60 [08:45<08:12, 17.00s/it, v_num=1, train_loss_step=185, train_loss_epoch=313]Epoch 32/60:  53%|█████▎    | 32/60 [08:58<07:23, 15.84s/it, v_num=1, train_loss_step=185, train_loss_epoch=313]Epoch 32/60:  53%|█████▎    | 32/60 [08:58<07:23, 15.84s/it, v_num=1, train_loss_step=80.8, train_loss_epoch=312]Epoch 33/60:  53%|█████▎    | 32/60 [08:58<07:23, 15.84s/it, v_num=1, train_loss_step=80.8, train_loss_epoch=312]Epoch 33/60:  55%|█████▌    | 33/60 [09:11<06:45, 15.03s/it, v_num=1, train_loss_step=80.8, train_loss_epoch=312]Epoch 33/60:  55%|█████▌    | 33/60 [09:11<06:45, 15.03s/it, v_num=1, train_loss_step=1.04e+3, train_loss_epoch=312]Epoch 34/60:  55%|█████▌    | 33/60 [09:11<06:45, 15.03s/it, v_num=1, train_loss_step=1.04e+3, train_loss_epoch=312]Epoch 34/60:  57%|█████▋    | 34/60 [09:24<06:11, 14.29s/it, v_num=1, train_loss_step=1.04e+3, train_loss_epoch=312]Epoch 34/60:  57%|█████▋    | 34/60 [09:24<06:11, 14.29s/it, v_num=1, train_loss_step=278, train_loss_epoch=312]    Epoch 35/60:  57%|█████▋    | 34/60 [09:24<06:11, 14.29s/it, v_num=1, train_loss_step=278, train_loss_epoch=312]Epoch 35/60:  58%|█████▊    | 35/60 [09:39<06:08, 14.73s/it, v_num=1, train_loss_step=278, train_loss_epoch=312]Epoch 35/60:  58%|█████▊    | 35/60 [09:39<06:08, 14.73s/it, v_num=1, train_loss_step=0.428, train_loss_epoch=312]Epoch 36/60:  58%|█████▊    | 35/60 [09:39<06:08, 14.73s/it, v_num=1, train_loss_step=0.428, train_loss_epoch=312]Epoch 36/60:  60%|██████    | 36/60 [09:59<06:28, 16.20s/it, v_num=1, train_loss_step=0.428, train_loss_epoch=312]Epoch 36/60:  60%|██████    | 36/60 [09:59<06:28, 16.20s/it, v_num=1, train_loss_step=157, train_loss_epoch=311]  Epoch 37/60:  60%|██████    | 36/60 [09:59<06:28, 16.20s/it, v_num=1, train_loss_step=157, train_loss_epoch=311]Epoch 37/60:  62%|██████▏   | 37/60 [10:21<06:51, 17.91s/it, v_num=1, train_loss_step=157, train_loss_epoch=311]Epoch 37/60:  62%|██████▏   | 37/60 [10:21<06:51, 17.91s/it, v_num=1, train_loss_step=405, train_loss_epoch=311]Epoch 38/60:  62%|██████▏   | 37/60 [10:21<06:51, 17.91s/it, v_num=1, train_loss_step=405, train_loss_epoch=311]Epoch 38/60:  63%|██████▎   | 38/60 [10:45<07:17, 19.90s/it, v_num=1, train_loss_step=405, train_loss_epoch=311]Epoch 38/60:  63%|██████▎   | 38/60 [10:45<07:17, 19.90s/it, v_num=1, train_loss_step=562, train_loss_epoch=311]Epoch 39/60:  63%|██████▎   | 38/60 [10:45<07:17, 19.90s/it, v_num=1, train_loss_step=562, train_loss_epoch=311]Epoch 39/60:  65%|██████▌   | 39/60 [11:20<08:31, 24.36s/it, v_num=1, train_loss_step=562, train_loss_epoch=311]Epoch 39/60:  65%|██████▌   | 39/60 [11:20<08:31, 24.36s/it, v_num=1, train_loss_step=322, train_loss_epoch=310]Epoch 40/60:  65%|██████▌   | 39/60 [11:20<08:31, 24.36s/it, v_num=1, train_loss_step=322, train_loss_epoch=310]Epoch 40/60:  67%|██████▋   | 40/60 [11:36<07:17, 21.87s/it, v_num=1, train_loss_step=322, train_loss_epoch=310]Epoch 40/60:  67%|██████▋   | 40/60 [11:36<07:17, 21.87s/it, v_num=1, train_loss_step=388, train_loss_epoch=310]Epoch 41/60:  67%|██████▋   | 40/60 [11:36<07:17, 21.87s/it, v_num=1, train_loss_step=388, train_loss_epoch=310]Epoch 41/60:  68%|██████▊   | 41/60 [11:50<06:11, 19.55s/it, v_num=1, train_loss_step=388, train_loss_epoch=310]Epoch 41/60:  68%|██████▊   | 41/60 [11:50<06:11, 19.55s/it, v_num=1, train_loss_step=406, train_loss_epoch=309]Epoch 42/60:  68%|██████▊   | 41/60 [11:50<06:11, 19.55s/it, v_num=1, train_loss_step=406, train_loss_epoch=309]Epoch 42/60:  70%|███████   | 42/60 [12:10<05:51, 19.55s/it, v_num=1, train_loss_step=406, train_loss_epoch=309]Epoch 42/60:  70%|███████   | 42/60 [12:10<05:51, 19.55s/it, v_num=1, train_loss_step=409, train_loss_epoch=310]Epoch 43/60:  70%|███████   | 42/60 [12:10<05:51, 19.55s/it, v_num=1, train_loss_step=409, train_loss_epoch=310]Epoch 43/60:  72%|███████▏  | 43/60 [12:32<05:47, 20.44s/it, v_num=1, train_loss_step=409, train_loss_epoch=310]Epoch 43/60:  72%|███████▏  | 43/60 [12:32<05:47, 20.44s/it, v_num=1, train_loss_step=381, train_loss_epoch=309]Epoch 44/60:  72%|███████▏  | 43/60 [12:32<05:47, 20.44s/it, v_num=1, train_loss_step=381, train_loss_epoch=309]Epoch 44/60:  73%|███████▎  | 44/60 [12:50<05:10, 19.44s/it, v_num=1, train_loss_step=381, train_loss_epoch=309]Epoch 44/60:  73%|███████▎  | 44/60 [12:50<05:10, 19.44s/it, v_num=1, train_loss_step=314, train_loss_epoch=309]Epoch 45/60:  73%|███████▎  | 44/60 [12:50<05:10, 19.44s/it, v_num=1, train_loss_step=314, train_loss_epoch=309]Epoch 45/60:  75%|███████▌  | 45/60 [13:14<05:16, 21.08s/it, v_num=1, train_loss_step=314, train_loss_epoch=309]Epoch 45/60:  75%|███████▌  | 45/60 [13:14<05:16, 21.08s/it, v_num=1, train_loss_step=656, train_loss_epoch=309]Epoch 46/60:  75%|███████▌  | 45/60 [13:14<05:16, 21.08s/it, v_num=1, train_loss_step=656, train_loss_epoch=309]Epoch 46/60:  77%|███████▋  | 46/60 [13:31<04:36, 19.77s/it, v_num=1, train_loss_step=656, train_loss_epoch=309]Epoch 46/60:  77%|███████▋  | 46/60 [13:31<04:36, 19.77s/it, v_num=1, train_loss_step=823, train_loss_epoch=309]Epoch 47/60:  77%|███████▋  | 46/60 [13:31<04:36, 19.77s/it, v_num=1, train_loss_step=823, train_loss_epoch=309]Epoch 47/60:  78%|███████▊  | 47/60 [13:45<03:54, 18.05s/it, v_num=1, train_loss_step=823, train_loss_epoch=309]Epoch 47/60:  78%|███████▊  | 47/60 [13:45<03:54, 18.05s/it, v_num=1, train_loss_step=324, train_loss_epoch=308]Epoch 48/60:  78%|███████▊  | 47/60 [13:45<03:54, 18.05s/it, v_num=1, train_loss_step=324, train_loss_epoch=308]Epoch 48/60:  80%|████████  | 48/60 [14:11<04:02, 20.25s/it, v_num=1, train_loss_step=324, train_loss_epoch=308]Epoch 48/60:  80%|████████  | 48/60 [14:11<04:02, 20.25s/it, v_num=1, train_loss_step=383, train_loss_epoch=308]Epoch 49/60:  80%|████████  | 48/60 [14:11<04:02, 20.25s/it, v_num=1, train_loss_step=383, train_loss_epoch=308]Epoch 49/60:  82%|████████▏ | 49/60 [14:30<03:41, 20.11s/it, v_num=1, train_loss_step=383, train_loss_epoch=308]Epoch 49/60:  82%|████████▏ | 49/60 [14:30<03:41, 20.11s/it, v_num=1, train_loss_step=216, train_loss_epoch=308]Epoch 50/60:  82%|████████▏ | 49/60 [14:30<03:41, 20.11s/it, v_num=1, train_loss_step=216, train_loss_epoch=308]Epoch 50/60:  83%|████████▎ | 50/60 [14:49<03:15, 19.54s/it, v_num=1, train_loss_step=216, train_loss_epoch=308]Epoch 50/60:  83%|████████▎ | 50/60 [14:49<03:15, 19.54s/it, v_num=1, train_loss_step=270, train_loss_epoch=307]Epoch 51/60:  83%|████████▎ | 50/60 [14:49<03:15, 19.54s/it, v_num=1, train_loss_step=270, train_loss_epoch=307]Epoch 51/60:  85%|████████▌ | 51/60 [15:02<02:40, 17.82s/it, v_num=1, train_loss_step=270, train_loss_epoch=307]Epoch 51/60:  85%|████████▌ | 51/60 [15:02<02:40, 17.82s/it, v_num=1, train_loss_step=414, train_loss_epoch=307]Epoch 52/60:  85%|████████▌ | 51/60 [15:02<02:40, 17.82s/it, v_num=1, train_loss_step=414, train_loss_epoch=307]Epoch 52/60:  87%|████████▋ | 52/60 [15:18<02:16, 17.09s/it, v_num=1, train_loss_step=414, train_loss_epoch=307]Epoch 52/60:  87%|████████▋ | 52/60 [15:18<02:16, 17.09s/it, v_num=1, train_loss_step=946, train_loss_epoch=307]Epoch 53/60:  87%|████████▋ | 52/60 [15:18<02:16, 17.09s/it, v_num=1, train_loss_step=946, train_loss_epoch=307]Epoch 53/60:  88%|████████▊ | 53/60 [15:34<01:57, 16.77s/it, v_num=1, train_loss_step=946, train_loss_epoch=307]Epoch 53/60:  88%|████████▊ | 53/60 [15:34<01:57, 16.77s/it, v_num=1, train_loss_step=185, train_loss_epoch=307]Epoch 54/60:  88%|████████▊ | 53/60 [15:34<01:57, 16.77s/it, v_num=1, train_loss_step=185, train_loss_epoch=307]Epoch 54/60:  90%|█████████ | 54/60 [15:51<01:41, 17.00s/it, v_num=1, train_loss_step=185, train_loss_epoch=307]Epoch 54/60:  90%|█████████ | 54/60 [15:51<01:41, 17.00s/it, v_num=1, train_loss_step=0.467, train_loss_epoch=306]Epoch 55/60:  90%|█████████ | 54/60 [15:51<01:41, 17.00s/it, v_num=1, train_loss_step=0.467, train_loss_epoch=306]Epoch 55/60:  92%|█████████▏| 55/60 [16:05<01:20, 16.02s/it, v_num=1, train_loss_step=0.467, train_loss_epoch=306]Epoch 55/60:  92%|█████████▏| 55/60 [16:05<01:20, 16.02s/it, v_num=1, train_loss_step=544, train_loss_epoch=306]  Epoch 56/60:  92%|█████████▏| 55/60 [16:05<01:20, 16.02s/it, v_num=1, train_loss_step=544, train_loss_epoch=306]Epoch 56/60:  93%|█████████▎| 56/60 [16:16<00:58, 14.57s/it, v_num=1, train_loss_step=544, train_loss_epoch=306]Epoch 56/60:  93%|█████████▎| 56/60 [16:16<00:58, 14.57s/it, v_num=1, train_loss_step=970, train_loss_epoch=306]Epoch 57/60:  93%|█████████▎| 56/60 [16:16<00:58, 14.57s/it, v_num=1, train_loss_step=970, train_loss_epoch=306]Epoch 57/60:  95%|█████████▌| 57/60 [16:29<00:41, 13.89s/it, v_num=1, train_loss_step=970, train_loss_epoch=306]Epoch 57/60:  95%|█████████▌| 57/60 [16:29<00:41, 13.89s/it, v_num=1, train_loss_step=345, train_loss_epoch=306]Epoch 58/60:  95%|█████████▌| 57/60 [16:29<00:41, 13.89s/it, v_num=1, train_loss_step=345, train_loss_epoch=306]Epoch 58/60:  97%|█████████▋| 58/60 [16:40<00:26, 13.11s/it, v_num=1, train_loss_step=345, train_loss_epoch=306]Epoch 58/60:  97%|█████████▋| 58/60 [16:40<00:26, 13.11s/it, v_num=1, train_loss_step=104, train_loss_epoch=305]Epoch 59/60:  97%|█████████▋| 58/60 [16:40<00:26, 13.11s/it, v_num=1, train_loss_step=104, train_loss_epoch=305]Epoch 59/60:  98%|█████████▊| 59/60 [16:52<00:12, 12.79s/it, v_num=1, train_loss_step=104, train_loss_epoch=305]Epoch 59/60:  98%|█████████▊| 59/60 [16:52<00:12, 12.79s/it, v_num=1, train_loss_step=366, train_loss_epoch=305]Epoch 60/60:  98%|█████████▊| 59/60 [16:52<00:12, 12.79s/it, v_num=1, train_loss_step=366, train_loss_epoch=305]Epoch 60/60: 100%|██████████| 60/60 [17:03<00:00, 12.34s/it, v_num=1, train_loss_step=366, train_loss_epoch=305]Epoch 60/60: 100%|██████████| 60/60 [17:03<00:00, 12.34s/it, v_num=1, train_loss_step=669, train_loss_epoch=305]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [17:03<00:00, 17.06s/it, v_num=1, train_loss_step=669, train_loss_epoch=305]2025-12-05 19:09:02,231 [INFO] Compare airspace scores after denoising
2025-12-05 19:09:03,257 [INFO] Writing summary of results to file
2025-12-05 19:09:03,259 [INFO] Plot scatter of correlation
/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/pericyte_analysis/_m/../_h/02.qc_airspace.py:178: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  corrs = df_melted.groupby("Model").apply(

Summary results saved to: results/airspace/agtr1_model_summary.txt
Saved melted correlation data to: results/airspace/pericytes_airspace_denoising.tsv
-----
anndata             0.11.4
matplotlib          3.10.5
numpy               1.26.4
pandas              2.3.2
scanpy              1.11.4
scipy               1.15.3
scvi                1.3.3
seaborn             0.13.2
session_info        v1.0.1
sklearn             1.7.2
statsmodels         0.14.5
-----
Python 3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]
Linux-4.18.0-553.30.1.el8_10.x86_64-x86_64-with-glibc2.28
-----
Session information updated at 2025-12-05 19:09
2025-12-05 19:09:58 - **** Job ends ****
