2025-12-21 21:24:27 - **** Job starts ****
2025-12-21 21:24:27 - **** Bridges-2 info ****
User: kbenjamin
Job id: 36670365
Job name: airspace_denoising
Node name: 
Hostname: r025
Task id: N/A

Currently Loaded Modules:
  1) anaconda3/2024.10-1   2) gcc/13.3.1-p20240614

 

2025-12-21 21:24:28 - **** Loading mamba environment ****
2025-12-21 21:24:29 - **** Run analysis ****
2025-12-21 21:31:00,962 [INFO] Define masks
2025-12-21 21:31:01,395 [INFO] Subset data for training: perivascular
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-21 21:31:22,712 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 10 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [02:19<2:17:00, 139.34s/it]Epoch 1/60:   2%|▏         | 1/60 [02:19<2:17:00, 139.34s/it, v_num=1, train_loss_step=457, train_loss_epoch=500]Epoch 2/60:   2%|▏         | 1/60 [02:19<2:17:00, 139.34s/it, v_num=1, train_loss_step=457, train_loss_epoch=500]Epoch 2/60:   3%|▎         | 2/60 [04:37<2:13:59, 138.61s/it, v_num=1, train_loss_step=457, train_loss_epoch=500]Epoch 2/60:   3%|▎         | 2/60 [04:37<2:13:59, 138.61s/it, v_num=1, train_loss_step=764, train_loss_epoch=459]Epoch 3/60:   3%|▎         | 2/60 [04:37<2:13:59, 138.61s/it, v_num=1, train_loss_step=764, train_loss_epoch=459]Epoch 3/60:   5%|▌         | 3/60 [06:54<2:11:12, 138.11s/it, v_num=1, train_loss_step=764, train_loss_epoch=459]Epoch 3/60:   5%|▌         | 3/60 [06:54<2:11:12, 138.11s/it, v_num=1, train_loss_step=337, train_loss_epoch=452]Epoch 4/60:   5%|▌         | 3/60 [06:54<2:11:12, 138.11s/it, v_num=1, train_loss_step=337, train_loss_epoch=452]Epoch 4/60:   7%|▋         | 4/60 [09:13<2:09:06, 138.34s/it, v_num=1, train_loss_step=337, train_loss_epoch=452]Epoch 4/60:   7%|▋         | 4/60 [09:13<2:09:06, 138.34s/it, v_num=1, train_loss_step=407, train_loss_epoch=447]Epoch 5/60:   7%|▋         | 4/60 [09:13<2:09:06, 138.34s/it, v_num=1, train_loss_step=407, train_loss_epoch=447]Epoch 5/60:   8%|▊         | 5/60 [11:37<2:08:43, 140.42s/it, v_num=1, train_loss_step=407, train_loss_epoch=447]Epoch 5/60:   8%|▊         | 5/60 [11:37<2:08:43, 140.42s/it, v_num=1, train_loss_step=314, train_loss_epoch=444]Epoch 6/60:   8%|▊         | 5/60 [11:37<2:08:43, 140.42s/it, v_num=1, train_loss_step=314, train_loss_epoch=444]Epoch 6/60:  10%|█         | 6/60 [14:07<2:09:20, 143.71s/it, v_num=1, train_loss_step=314, train_loss_epoch=444]Epoch 6/60:  10%|█         | 6/60 [14:07<2:09:20, 143.71s/it, v_num=1, train_loss_step=345, train_loss_epoch=442]Epoch 7/60:  10%|█         | 6/60 [14:07<2:09:20, 143.71s/it, v_num=1, train_loss_step=345, train_loss_epoch=442]Epoch 7/60:  12%|█▏        | 7/60 [16:32<2:07:04, 143.86s/it, v_num=1, train_loss_step=345, train_loss_epoch=442]Epoch 7/60:  12%|█▏        | 7/60 [16:32<2:07:04, 143.86s/it, v_num=1, train_loss_step=412, train_loss_epoch=440]Epoch 8/60:  12%|█▏        | 7/60 [16:32<2:07:04, 143.86s/it, v_num=1, train_loss_step=412, train_loss_epoch=440]Epoch 8/60:  13%|█▎        | 8/60 [18:55<2:04:29, 143.64s/it, v_num=1, train_loss_step=412, train_loss_epoch=440]Epoch 8/60:  13%|█▎        | 8/60 [18:55<2:04:29, 143.64s/it, v_num=1, train_loss_step=454, train_loss_epoch=438]Epoch 9/60:  13%|█▎        | 8/60 [18:55<2:04:29, 143.64s/it, v_num=1, train_loss_step=454, train_loss_epoch=438]Epoch 9/60:  15%|█▌        | 9/60 [21:19<2:02:22, 143.98s/it, v_num=1, train_loss_step=454, train_loss_epoch=438]Epoch 9/60:  15%|█▌        | 9/60 [21:19<2:02:22, 143.98s/it, v_num=1, train_loss_step=1.09e+3, train_loss_epoch=437]Epoch 10/60:  15%|█▌        | 9/60 [21:19<2:02:22, 143.98s/it, v_num=1, train_loss_step=1.09e+3, train_loss_epoch=437]Epoch 10/60:  17%|█▋        | 10/60 [23:46<2:00:35, 144.71s/it, v_num=1, train_loss_step=1.09e+3, train_loss_epoch=437]Epoch 10/60:  17%|█▋        | 10/60 [23:46<2:00:35, 144.71s/it, v_num=1, train_loss_step=437, train_loss_epoch=437]    Epoch 11/60:  17%|█▋        | 10/60 [23:46<2:00:35, 144.71s/it, v_num=1, train_loss_step=437, train_loss_epoch=437]Epoch 11/60:  18%|█▊        | 11/60 [26:13<1:58:42, 145.35s/it, v_num=1, train_loss_step=437, train_loss_epoch=437]Epoch 11/60:  18%|█▊        | 11/60 [26:13<1:58:42, 145.35s/it, v_num=1, train_loss_step=251, train_loss_epoch=436]Epoch 12/60:  18%|█▊        | 11/60 [26:13<1:58:42, 145.35s/it, v_num=1, train_loss_step=251, train_loss_epoch=436]Epoch 12/60:  20%|██        | 12/60 [28:36<1:55:47, 144.73s/it, v_num=1, train_loss_step=251, train_loss_epoch=436]Epoch 12/60:  20%|██        | 12/60 [28:36<1:55:47, 144.73s/it, v_num=1, train_loss_step=316, train_loss_epoch=435]Epoch 13/60:  20%|██        | 12/60 [28:36<1:55:47, 144.73s/it, v_num=1, train_loss_step=316, train_loss_epoch=435]Epoch 13/60:  22%|██▏       | 13/60 [30:56<1:52:11, 143.22s/it, v_num=1, train_loss_step=316, train_loss_epoch=435]Epoch 13/60:  22%|██▏       | 13/60 [30:56<1:52:11, 143.22s/it, v_num=1, train_loss_step=642, train_loss_epoch=435]Epoch 14/60:  22%|██▏       | 13/60 [30:56<1:52:11, 143.22s/it, v_num=1, train_loss_step=642, train_loss_epoch=435]Epoch 14/60:  23%|██▎       | 14/60 [33:06<1:46:56, 139.48s/it, v_num=1, train_loss_step=642, train_loss_epoch=435]Epoch 14/60:  23%|██▎       | 14/60 [33:06<1:46:56, 139.48s/it, v_num=1, train_loss_step=587, train_loss_epoch=434]Epoch 15/60:  23%|██▎       | 14/60 [33:06<1:46:56, 139.48s/it, v_num=1, train_loss_step=587, train_loss_epoch=434]Epoch 15/60:  25%|██▌       | 15/60 [35:18<1:42:55, 137.23s/it, v_num=1, train_loss_step=587, train_loss_epoch=434]Epoch 15/60:  25%|██▌       | 15/60 [35:18<1:42:55, 137.23s/it, v_num=1, train_loss_step=161, train_loss_epoch=434]Epoch 16/60:  25%|██▌       | 15/60 [35:18<1:42:55, 137.23s/it, v_num=1, train_loss_step=161, train_loss_epoch=434]Epoch 16/60:  27%|██▋       | 16/60 [37:28<1:38:50, 134.78s/it, v_num=1, train_loss_step=161, train_loss_epoch=434]Epoch 16/60:  27%|██▋       | 16/60 [37:28<1:38:50, 134.78s/it, v_num=1, train_loss_step=411, train_loss_epoch=433]Epoch 17/60:  27%|██▋       | 16/60 [37:28<1:38:50, 134.78s/it, v_num=1, train_loss_step=411, train_loss_epoch=433]Epoch 17/60:  28%|██▊       | 17/60 [39:37<1:35:26, 133.17s/it, v_num=1, train_loss_step=411, train_loss_epoch=433]Epoch 17/60:  28%|██▊       | 17/60 [39:37<1:35:26, 133.17s/it, v_num=1, train_loss_step=826, train_loss_epoch=433]Epoch 18/60:  28%|██▊       | 17/60 [39:37<1:35:26, 133.17s/it, v_num=1, train_loss_step=826, train_loss_epoch=433]Epoch 18/60:  30%|███       | 18/60 [41:59<1:35:01, 135.76s/it, v_num=1, train_loss_step=826, train_loss_epoch=433]Epoch 18/60:  30%|███       | 18/60 [41:59<1:35:01, 135.76s/it, v_num=1, train_loss_step=116, train_loss_epoch=433]Epoch 19/60:  30%|███       | 18/60 [41:59<1:35:01, 135.76s/it, v_num=1, train_loss_step=116, train_loss_epoch=433]Epoch 19/60:  32%|███▏      | 19/60 [44:01<1:29:57, 131.63s/it, v_num=1, train_loss_step=116, train_loss_epoch=433]Epoch 19/60:  32%|███▏      | 19/60 [44:01<1:29:57, 131.63s/it, v_num=1, train_loss_step=484, train_loss_epoch=432]Epoch 20/60:  32%|███▏      | 19/60 [44:01<1:29:57, 131.63s/it, v_num=1, train_loss_step=484, train_loss_epoch=432]Epoch 20/60:  33%|███▎      | 20/60 [46:02<1:25:44, 128.60s/it, v_num=1, train_loss_step=484, train_loss_epoch=432]Epoch 20/60:  33%|███▎      | 20/60 [46:02<1:25:44, 128.60s/it, v_num=1, train_loss_step=133, train_loss_epoch=432]Epoch 21/60:  33%|███▎      | 20/60 [46:02<1:25:44, 128.60s/it, v_num=1, train_loss_step=133, train_loss_epoch=432]Epoch 21/60:  35%|███▌      | 21/60 [48:07<1:22:48, 127.40s/it, v_num=1, train_loss_step=133, train_loss_epoch=432]Epoch 21/60:  35%|███▌      | 21/60 [48:07<1:22:48, 127.40s/it, v_num=1, train_loss_step=379, train_loss_epoch=432]Epoch 22/60:  35%|███▌      | 21/60 [48:07<1:22:48, 127.40s/it, v_num=1, train_loss_step=379, train_loss_epoch=432]Epoch 22/60:  37%|███▋      | 22/60 [50:27<1:23:02, 131.12s/it, v_num=1, train_loss_step=379, train_loss_epoch=432]Epoch 22/60:  37%|███▋      | 22/60 [50:27<1:23:02, 131.12s/it, v_num=1, train_loss_step=378, train_loss_epoch=432]Epoch 23/60:  37%|███▋      | 22/60 [50:27<1:23:02, 131.12s/it, v_num=1, train_loss_step=378, train_loss_epoch=432]Epoch 23/60:  38%|███▊      | 23/60 [52:55<1:24:07, 136.42s/it, v_num=1, train_loss_step=378, train_loss_epoch=432]Epoch 23/60:  38%|███▊      | 23/60 [52:55<1:24:07, 136.42s/it, v_num=1, train_loss_step=372, train_loss_epoch=431]Epoch 24/60:  38%|███▊      | 23/60 [52:55<1:24:07, 136.42s/it, v_num=1, train_loss_step=372, train_loss_epoch=431]Epoch 24/60:  40%|████      | 24/60 [55:25<1:24:12, 140.36s/it, v_num=1, train_loss_step=372, train_loss_epoch=431]Epoch 24/60:  40%|████      | 24/60 [55:25<1:24:12, 140.36s/it, v_num=1, train_loss_step=113, train_loss_epoch=431]Epoch 25/60:  40%|████      | 24/60 [55:25<1:24:12, 140.36s/it, v_num=1, train_loss_step=113, train_loss_epoch=431]Epoch 25/60:  42%|████▏     | 25/60 [57:41<1:21:02, 138.92s/it, v_num=1, train_loss_step=113, train_loss_epoch=431]Epoch 25/60:  42%|████▏     | 25/60 [57:41<1:21:02, 138.92s/it, v_num=1, train_loss_step=416, train_loss_epoch=431]Epoch 26/60:  42%|████▏     | 25/60 [57:41<1:21:02, 138.92s/it, v_num=1, train_loss_step=416, train_loss_epoch=431]Epoch 26/60:  43%|████▎     | 26/60 [59:53<1:17:38, 137.01s/it, v_num=1, train_loss_step=416, train_loss_epoch=431]Epoch 26/60:  43%|████▎     | 26/60 [59:53<1:17:38, 137.01s/it, v_num=1, train_loss_step=408, train_loss_epoch=431]Epoch 27/60:  43%|████▎     | 26/60 [59:53<1:17:38, 137.01s/it, v_num=1, train_loss_step=408, train_loss_epoch=431]Epoch 27/60:  45%|████▌     | 27/60 [1:02:04<1:14:18, 135.12s/it, v_num=1, train_loss_step=408, train_loss_epoch=431]Epoch 27/60:  45%|████▌     | 27/60 [1:02:04<1:14:18, 135.12s/it, v_num=1, train_loss_step=644, train_loss_epoch=431]Epoch 28/60:  45%|████▌     | 27/60 [1:02:04<1:14:18, 135.12s/it, v_num=1, train_loss_step=644, train_loss_epoch=431]Epoch 28/60:  47%|████▋     | 28/60 [1:04:28<1:13:32, 137.90s/it, v_num=1, train_loss_step=644, train_loss_epoch=431]Epoch 28/60:  47%|████▋     | 28/60 [1:04:28<1:13:32, 137.90s/it, v_num=1, train_loss_step=72.1, train_loss_epoch=430]Epoch 29/60:  47%|████▋     | 28/60 [1:04:28<1:13:32, 137.90s/it, v_num=1, train_loss_step=72.1, train_loss_epoch=430]Epoch 29/60:  48%|████▊     | 29/60 [1:06:41<1:10:31, 136.50s/it, v_num=1, train_loss_step=72.1, train_loss_epoch=430]Epoch 29/60:  48%|████▊     | 29/60 [1:06:42<1:10:31, 136.50s/it, v_num=1, train_loss_step=150, train_loss_epoch=430] Epoch 30/60:  48%|████▊     | 29/60 [1:06:42<1:10:31, 136.50s/it, v_num=1, train_loss_step=150, train_loss_epoch=430]Epoch 30/60:  50%|█████     | 30/60 [1:08:54<1:07:39, 135.31s/it, v_num=1, train_loss_step=150, train_loss_epoch=430]Epoch 30/60:  50%|█████     | 30/60 [1:08:54<1:07:39, 135.31s/it, v_num=1, train_loss_step=668, train_loss_epoch=430]Epoch 31/60:  50%|█████     | 30/60 [1:08:54<1:07:39, 135.31s/it, v_num=1, train_loss_step=668, train_loss_epoch=430]Epoch 31/60:  52%|█████▏    | 31/60 [1:11:00<1:04:02, 132.52s/it, v_num=1, train_loss_step=668, train_loss_epoch=430]Epoch 31/60:  52%|█████▏    | 31/60 [1:11:00<1:04:02, 132.52s/it, v_num=1, train_loss_step=382, train_loss_epoch=430]Epoch 32/60:  52%|█████▏    | 31/60 [1:11:00<1:04:02, 132.52s/it, v_num=1, train_loss_step=382, train_loss_epoch=430]Epoch 32/60:  53%|█████▎    | 32/60 [1:13:07<1:01:08, 131.00s/it, v_num=1, train_loss_step=382, train_loss_epoch=430]Epoch 32/60:  53%|█████▎    | 32/60 [1:13:07<1:01:08, 131.00s/it, v_num=1, train_loss_step=104, train_loss_epoch=430]Epoch 33/60:  53%|█████▎    | 32/60 [1:13:07<1:01:08, 131.00s/it, v_num=1, train_loss_step=104, train_loss_epoch=430]Epoch 33/60:  55%|█████▌    | 33/60 [1:15:19<59:05, 131.31s/it, v_num=1, train_loss_step=104, train_loss_epoch=430]  Epoch 33/60:  55%|█████▌    | 33/60 [1:15:19<59:05, 131.31s/it, v_num=1, train_loss_step=206, train_loss_epoch=430]Epoch 34/60:  55%|█████▌    | 33/60 [1:15:19<59:05, 131.31s/it, v_num=1, train_loss_step=206, train_loss_epoch=430]Epoch 34/60:  57%|█████▋    | 34/60 [1:17:32<57:05, 131.75s/it, v_num=1, train_loss_step=206, train_loss_epoch=430]Epoch 34/60:  57%|█████▋    | 34/60 [1:17:32<57:05, 131.75s/it, v_num=1, train_loss_step=166, train_loss_epoch=430]Epoch 35/60:  57%|█████▋    | 34/60 [1:17:32<57:05, 131.75s/it, v_num=1, train_loss_step=166, train_loss_epoch=430]Epoch 35/60:  58%|█████▊    | 35/60 [1:19:45<55:00, 132.03s/it, v_num=1, train_loss_step=166, train_loss_epoch=430]Epoch 35/60:  58%|█████▊    | 35/60 [1:19:45<55:00, 132.03s/it, v_num=1, train_loss_step=496, train_loss_epoch=429]Epoch 36/60:  58%|█████▊    | 35/60 [1:19:45<55:00, 132.03s/it, v_num=1, train_loss_step=496, train_loss_epoch=429]Epoch 36/60:  60%|██████    | 36/60 [1:21:59<53:04, 132.69s/it, v_num=1, train_loss_step=496, train_loss_epoch=429]Epoch 36/60:  60%|██████    | 36/60 [1:21:59<53:04, 132.69s/it, v_num=1, train_loss_step=264, train_loss_epoch=429]Epoch 37/60:  60%|██████    | 36/60 [1:21:59<53:04, 132.69s/it, v_num=1, train_loss_step=264, train_loss_epoch=429]Epoch 37/60:  62%|██████▏   | 37/60 [1:24:18<51:32, 134.45s/it, v_num=1, train_loss_step=264, train_loss_epoch=429]Epoch 37/60:  62%|██████▏   | 37/60 [1:24:18<51:32, 134.45s/it, v_num=1, train_loss_step=595, train_loss_epoch=429]Epoch 38/60:  62%|██████▏   | 37/60 [1:24:18<51:32, 134.45s/it, v_num=1, train_loss_step=595, train_loss_epoch=429]Epoch 38/60:  63%|██████▎   | 38/60 [1:26:30<49:00, 133.64s/it, v_num=1, train_loss_step=595, train_loss_epoch=429]Epoch 38/60:  63%|██████▎   | 38/60 [1:26:30<49:00, 133.64s/it, v_num=1, train_loss_step=609, train_loss_epoch=429]Epoch 39/60:  63%|██████▎   | 38/60 [1:26:30<49:00, 133.64s/it, v_num=1, train_loss_step=609, train_loss_epoch=429]Epoch 39/60:  65%|██████▌   | 39/60 [1:28:33<45:44, 130.67s/it, v_num=1, train_loss_step=609, train_loss_epoch=429]Epoch 39/60:  65%|██████▌   | 39/60 [1:28:33<45:44, 130.67s/it, v_num=1, train_loss_step=374, train_loss_epoch=429]Epoch 40/60:  65%|██████▌   | 39/60 [1:28:33<45:44, 130.67s/it, v_num=1, train_loss_step=374, train_loss_epoch=429]Epoch 40/60:  67%|██████▋   | 40/60 [1:30:26<41:44, 125.24s/it, v_num=1, train_loss_step=374, train_loss_epoch=429]Epoch 40/60:  67%|██████▋   | 40/60 [1:30:26<41:44, 125.24s/it, v_num=1, train_loss_step=281, train_loss_epoch=429]Epoch 41/60:  67%|██████▋   | 40/60 [1:30:26<41:44, 125.24s/it, v_num=1, train_loss_step=281, train_loss_epoch=429]Epoch 41/60:  68%|██████▊   | 41/60 [1:32:24<38:58, 123.06s/it, v_num=1, train_loss_step=281, train_loss_epoch=429]Epoch 41/60:  68%|██████▊   | 41/60 [1:32:24<38:58, 123.06s/it, v_num=1, train_loss_step=229, train_loss_epoch=429]Epoch 42/60:  68%|██████▊   | 41/60 [1:32:24<38:58, 123.06s/it, v_num=1, train_loss_step=229, train_loss_epoch=429]Epoch 42/60:  70%|███████   | 42/60 [1:34:25<36:47, 122.61s/it, v_num=1, train_loss_step=229, train_loss_epoch=429]Epoch 42/60:  70%|███████   | 42/60 [1:34:25<36:47, 122.61s/it, v_num=1, train_loss_step=470, train_loss_epoch=429]Epoch 43/60:  70%|███████   | 42/60 [1:34:25<36:47, 122.61s/it, v_num=1, train_loss_step=470, train_loss_epoch=429]Epoch 43/60:  72%|███████▏  | 43/60 [1:36:28<34:44, 122.62s/it, v_num=1, train_loss_step=470, train_loss_epoch=429]Epoch 43/60:  72%|███████▏  | 43/60 [1:36:28<34:44, 122.62s/it, v_num=1, train_loss_step=451, train_loss_epoch=429]Epoch 44/60:  72%|███████▏  | 43/60 [1:36:28<34:44, 122.62s/it, v_num=1, train_loss_step=451, train_loss_epoch=429]Epoch 44/60:  73%|███████▎  | 44/60 [1:38:37<33:13, 124.62s/it, v_num=1, train_loss_step=451, train_loss_epoch=429]Epoch 44/60:  73%|███████▎  | 44/60 [1:38:37<33:13, 124.62s/it, v_num=1, train_loss_step=485, train_loss_epoch=429]Epoch 45/60:  73%|███████▎  | 44/60 [1:38:37<33:13, 124.62s/it, v_num=1, train_loss_step=485, train_loss_epoch=429]Epoch 45/60:  75%|███████▌  | 45/60 [1:40:38<30:52, 123.53s/it, v_num=1, train_loss_step=485, train_loss_epoch=429]Epoch 45/60:  75%|███████▌  | 45/60 [1:40:38<30:52, 123.53s/it, v_num=1, train_loss_step=710, train_loss_epoch=428]Epoch 46/60:  75%|███████▌  | 45/60 [1:40:38<30:52, 123.53s/it, v_num=1, train_loss_step=710, train_loss_epoch=428]Epoch 46/60:  77%|███████▋  | 46/60 [1:42:42<28:48, 123.48s/it, v_num=1, train_loss_step=710, train_loss_epoch=428]Epoch 46/60:  77%|███████▋  | 46/60 [1:42:42<28:48, 123.48s/it, v_num=1, train_loss_step=428, train_loss_epoch=428]Epoch 47/60:  77%|███████▋  | 46/60 [1:42:42<28:48, 123.48s/it, v_num=1, train_loss_step=428, train_loss_epoch=428]Epoch 47/60:  78%|███████▊  | 47/60 [1:44:44<26:40, 123.10s/it, v_num=1, train_loss_step=428, train_loss_epoch=428]Epoch 47/60:  78%|███████▊  | 47/60 [1:44:44<26:40, 123.10s/it, v_num=1, train_loss_step=399, train_loss_epoch=428]Epoch 48/60:  78%|███████▊  | 47/60 [1:44:44<26:40, 123.10s/it, v_num=1, train_loss_step=399, train_loss_epoch=428]Epoch 48/60:  80%|████████  | 48/60 [1:46:49<24:44, 123.75s/it, v_num=1, train_loss_step=399, train_loss_epoch=428]Epoch 48/60:  80%|████████  | 48/60 [1:46:49<24:44, 123.75s/it, v_num=1, train_loss_step=175, train_loss_epoch=428]Epoch 49/60:  80%|████████  | 48/60 [1:46:49<24:44, 123.75s/it, v_num=1, train_loss_step=175, train_loss_epoch=428]Epoch 49/60:  82%|████████▏ | 49/60 [1:48:52<22:37, 123.44s/it, v_num=1, train_loss_step=175, train_loss_epoch=428]Epoch 49/60:  82%|████████▏ | 49/60 [1:48:52<22:37, 123.44s/it, v_num=1, train_loss_step=245, train_loss_epoch=428]Epoch 50/60:  82%|████████▏ | 49/60 [1:48:52<22:37, 123.44s/it, v_num=1, train_loss_step=245, train_loss_epoch=428]Epoch 50/60:  83%|████████▎ | 50/60 [1:54:49<32:16, 193.60s/it, v_num=1, train_loss_step=245, train_loss_epoch=428]Epoch 50/60:  83%|████████▎ | 50/60 [1:54:49<32:16, 193.60s/it, v_num=1, train_loss_step=292, train_loss_epoch=428]Epoch 51/60:  83%|████████▎ | 50/60 [1:54:49<32:16, 193.60s/it, v_num=1, train_loss_step=292, train_loss_epoch=428]Epoch 51/60:  85%|████████▌ | 51/60 [2:05:40<49:36, 330.67s/it, v_num=1, train_loss_step=292, train_loss_epoch=428]Epoch 51/60:  85%|████████▌ | 51/60 [2:05:40<49:36, 330.67s/it, v_num=1, train_loss_step=225, train_loss_epoch=428]Epoch 52/60:  85%|████████▌ | 51/60 [2:05:40<49:36, 330.67s/it, v_num=1, train_loss_step=225, train_loss_epoch=428]Epoch 52/60:  87%|████████▋ | 52/60 [2:21:09<1:08:02, 510.31s/it, v_num=1, train_loss_step=225, train_loss_epoch=428]Epoch 52/60:  87%|████████▋ | 52/60 [2:21:09<1:08:02, 510.31s/it, v_num=1, train_loss_step=231, train_loss_epoch=428]Epoch 53/60:  87%|████████▋ | 52/60 [2:21:09<1:08:02, 510.31s/it, v_num=1, train_loss_step=231, train_loss_epoch=428]Epoch 53/60:  88%|████████▊ | 53/60 [2:27:12<54:22, 466.07s/it, v_num=1, train_loss_step=231, train_loss_epoch=428]  Epoch 53/60:  88%|████████▊ | 53/60 [2:27:12<54:22, 466.07s/it, v_num=1, train_loss_step=223, train_loss_epoch=428]Epoch 54/60:  88%|████████▊ | 53/60 [2:27:12<54:22, 466.07s/it, v_num=1, train_loss_step=223, train_loss_epoch=428]Epoch 54/60:  90%|█████████ | 54/60 [2:39:37<54:57, 549.62s/it, v_num=1, train_loss_step=223, train_loss_epoch=428]Epoch 54/60:  90%|█████████ | 54/60 [2:39:37<54:57, 549.62s/it, v_num=1, train_loss_step=376, train_loss_epoch=428]Epoch 55/60:  90%|█████████ | 54/60 [2:39:37<54:57, 549.62s/it, v_num=1, train_loss_step=376, train_loss_epoch=428]Epoch 55/60:  92%|█████████▏| 55/60 [2:51:11<49:25, 593.11s/it, v_num=1, train_loss_step=376, train_loss_epoch=428]Epoch 55/60:  92%|█████████▏| 55/60 [2:51:11<49:25, 593.11s/it, v_num=1, train_loss_step=609, train_loss_epoch=428]Epoch 56/60:  92%|█████████▏| 55/60 [2:51:11<49:25, 593.11s/it, v_num=1, train_loss_step=609, train_loss_epoch=428]Epoch 56/60:  93%|█████████▎| 56/60 [2:53:27<30:23, 455.97s/it, v_num=1, train_loss_step=609, train_loss_epoch=428]Epoch 56/60:  93%|█████████▎| 56/60 [2:53:27<30:23, 455.97s/it, v_num=1, train_loss_step=222, train_loss_epoch=428]Epoch 57/60:  93%|█████████▎| 56/60 [2:53:27<30:23, 455.97s/it, v_num=1, train_loss_step=222, train_loss_epoch=428]Epoch 57/60:  95%|█████████▌| 57/60 [2:55:32<17:50, 356.74s/it, v_num=1, train_loss_step=222, train_loss_epoch=428]Epoch 57/60:  95%|█████████▌| 57/60 [2:55:32<17:50, 356.74s/it, v_num=1, train_loss_step=168, train_loss_epoch=428]Epoch 58/60:  95%|█████████▌| 57/60 [2:55:32<17:50, 356.74s/it, v_num=1, train_loss_step=168, train_loss_epoch=428]Epoch 58/60:  97%|█████████▋| 58/60 [2:57:32<09:31, 285.51s/it, v_num=1, train_loss_step=168, train_loss_epoch=428]Epoch 58/60:  97%|█████████▋| 58/60 [2:57:32<09:31, 285.51s/it, v_num=1, train_loss_step=566, train_loss_epoch=428]Epoch 59/60:  97%|█████████▋| 58/60 [2:57:32<09:31, 285.51s/it, v_num=1, train_loss_step=566, train_loss_epoch=428]Epoch 59/60:  98%|█████████▊| 59/60 [2:59:28<03:54, 234.72s/it, v_num=1, train_loss_step=566, train_loss_epoch=428]Epoch 59/60:  98%|█████████▊| 59/60 [2:59:28<03:54, 234.72s/it, v_num=1, train_loss_step=647, train_loss_epoch=428]Epoch 60/60:  98%|█████████▊| 59/60 [2:59:28<03:54, 234.72s/it, v_num=1, train_loss_step=647, train_loss_epoch=428]Epoch 60/60: 100%|██████████| 60/60 [3:01:24<00:00, 199.25s/it, v_num=1, train_loss_step=647, train_loss_epoch=428]Epoch 60/60: 100%|██████████| 60/60 [3:01:24<00:00, 199.25s/it, v_num=1, train_loss_step=613, train_loss_epoch=427]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [3:01:24<00:00, 181.42s/it, v_num=1, train_loss_step=613, train_loss_epoch=427]2025-12-22 00:48:59,239 [INFO] Subset data for training: pericytes
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-22 00:49:03,994 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 4 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.

Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [00:12<12:31, 12.73s/it]Epoch 1/60:   2%|▏         | 1/60 [00:12<12:31, 12.73s/it, v_num=1, train_loss_step=158, train_loss_epoch=477]Epoch 2/60:   2%|▏         | 1/60 [00:12<12:31, 12.73s/it, v_num=1, train_loss_step=158, train_loss_epoch=477]Epoch 2/60:   3%|▎         | 2/60 [00:22<10:49, 11.19s/it, v_num=1, train_loss_step=158, train_loss_epoch=477]Epoch 2/60:   3%|▎         | 2/60 [00:22<10:49, 11.19s/it, v_num=1, train_loss_step=171, train_loss_epoch=343]Epoch 3/60:   3%|▎         | 2/60 [00:22<10:49, 11.19s/it, v_num=1, train_loss_step=171, train_loss_epoch=343]Epoch 3/60:   5%|▌         | 3/60 [00:33<10:12, 10.75s/it, v_num=1, train_loss_step=171, train_loss_epoch=343]Epoch 3/60:   5%|▌         | 3/60 [00:33<10:12, 10.75s/it, v_num=1, train_loss_step=658, train_loss_epoch=333]Epoch 4/60:   5%|▌         | 3/60 [00:33<10:12, 10.75s/it, v_num=1, train_loss_step=658, train_loss_epoch=333]Epoch 4/60:   7%|▋         | 4/60 [00:50<12:38, 13.55s/it, v_num=1, train_loss_step=658, train_loss_epoch=333]Epoch 4/60:   7%|▋         | 4/60 [00:50<12:38, 13.55s/it, v_num=1, train_loss_step=295, train_loss_epoch=328]Epoch 5/60:   7%|▋         | 4/60 [00:50<12:38, 13.55s/it, v_num=1, train_loss_step=295, train_loss_epoch=328]Epoch 5/60:   8%|▊         | 5/60 [01:01<11:36, 12.66s/it, v_num=1, train_loss_step=295, train_loss_epoch=328]Epoch 5/60:   8%|▊         | 5/60 [01:01<11:36, 12.66s/it, v_num=1, train_loss_step=184, train_loss_epoch=325]Epoch 6/60:   8%|▊         | 5/60 [01:01<11:36, 12.66s/it, v_num=1, train_loss_step=184, train_loss_epoch=325]Epoch 6/60:  10%|█         | 6/60 [01:33<17:02, 18.94s/it, v_num=1, train_loss_step=184, train_loss_epoch=325]Epoch 6/60:  10%|█         | 6/60 [01:33<17:02, 18.94s/it, v_num=1, train_loss_step=581, train_loss_epoch=324]Epoch 7/60:  10%|█         | 6/60 [01:33<17:02, 18.94s/it, v_num=1, train_loss_step=581, train_loss_epoch=324]Epoch 7/60:  12%|█▏        | 7/60 [01:45<14:46, 16.72s/it, v_num=1, train_loss_step=581, train_loss_epoch=324]Epoch 7/60:  12%|█▏        | 7/60 [01:45<14:46, 16.72s/it, v_num=1, train_loss_step=184, train_loss_epoch=323]Epoch 8/60:  12%|█▏        | 7/60 [01:45<14:46, 16.72s/it, v_num=1, train_loss_step=184, train_loss_epoch=323]Epoch 8/60:  13%|█▎        | 8/60 [01:57<13:07, 15.15s/it, v_num=1, train_loss_step=184, train_loss_epoch=323]Epoch 8/60:  13%|█▎        | 8/60 [01:57<13:07, 15.15s/it, v_num=1, train_loss_step=458, train_loss_epoch=322]Epoch 9/60:  13%|█▎        | 8/60 [01:57<13:07, 15.15s/it, v_num=1, train_loss_step=458, train_loss_epoch=322]Epoch 9/60:  15%|█▌        | 9/60 [02:19<14:49, 17.45s/it, v_num=1, train_loss_step=458, train_loss_epoch=322]Epoch 9/60:  15%|█▌        | 9/60 [02:19<14:49, 17.45s/it, v_num=1, train_loss_step=160, train_loss_epoch=321]Epoch 10/60:  15%|█▌        | 9/60 [02:19<14:49, 17.45s/it, v_num=1, train_loss_step=160, train_loss_epoch=321]Epoch 10/60:  17%|█▋        | 10/60 [02:30<12:45, 15.30s/it, v_num=1, train_loss_step=160, train_loss_epoch=321]Epoch 10/60:  17%|█▋        | 10/60 [02:30<12:45, 15.30s/it, v_num=1, train_loss_step=355, train_loss_epoch=319]Epoch 11/60:  17%|█▋        | 10/60 [02:30<12:45, 15.30s/it, v_num=1, train_loss_step=355, train_loss_epoch=319]Epoch 11/60:  18%|█▊        | 11/60 [03:17<20:34, 25.19s/it, v_num=1, train_loss_step=355, train_loss_epoch=319]Epoch 11/60:  18%|█▊        | 11/60 [03:17<20:34, 25.19s/it, v_num=1, train_loss_step=279, train_loss_epoch=318]Epoch 12/60:  18%|█▊        | 11/60 [03:17<20:34, 25.19s/it, v_num=1, train_loss_step=279, train_loss_epoch=318]Epoch 12/60:  20%|██        | 12/60 [03:27<16:29, 20.61s/it, v_num=1, train_loss_step=279, train_loss_epoch=318]Epoch 12/60:  20%|██        | 12/60 [03:27<16:29, 20.61s/it, v_num=1, train_loss_step=1.33e+3, train_loss_epoch=318]Epoch 13/60:  20%|██        | 12/60 [03:27<16:29, 20.61s/it, v_num=1, train_loss_step=1.33e+3, train_loss_epoch=318]Epoch 13/60:  22%|██▏       | 13/60 [03:37<13:38, 17.41s/it, v_num=1, train_loss_step=1.33e+3, train_loss_epoch=318]Epoch 13/60:  22%|██▏       | 13/60 [03:37<13:38, 17.41s/it, v_num=1, train_loss_step=104, train_loss_epoch=317]    Epoch 14/60:  22%|██▏       | 13/60 [03:37<13:38, 17.41s/it, v_num=1, train_loss_step=104, train_loss_epoch=317]Epoch 14/60:  23%|██▎       | 14/60 [04:12<17:24, 22.70s/it, v_num=1, train_loss_step=104, train_loss_epoch=317]Epoch 14/60:  23%|██▎       | 14/60 [04:12<17:24, 22.70s/it, v_num=1, train_loss_step=134, train_loss_epoch=316]Epoch 15/60:  23%|██▎       | 14/60 [04:12<17:24, 22.70s/it, v_num=1, train_loss_step=134, train_loss_epoch=316]Epoch 15/60:  25%|██▌       | 15/60 [04:23<14:17, 19.05s/it, v_num=1, train_loss_step=134, train_loss_epoch=316]Epoch 15/60:  25%|██▌       | 15/60 [04:23<14:17, 19.05s/it, v_num=1, train_loss_step=321, train_loss_epoch=315]Epoch 16/60:  25%|██▌       | 15/60 [04:23<14:17, 19.05s/it, v_num=1, train_loss_step=321, train_loss_epoch=315]Epoch 16/60:  27%|██▋       | 16/60 [04:34<12:06, 16.52s/it, v_num=1, train_loss_step=321, train_loss_epoch=315]Epoch 16/60:  27%|██▋       | 16/60 [04:34<12:06, 16.52s/it, v_num=1, train_loss_step=0.092, train_loss_epoch=315]Epoch 17/60:  27%|██▋       | 16/60 [04:34<12:06, 16.52s/it, v_num=1, train_loss_step=0.092, train_loss_epoch=315]Epoch 17/60:  28%|██▊       | 17/60 [04:45<10:46, 15.04s/it, v_num=1, train_loss_step=0.092, train_loss_epoch=315]Epoch 17/60:  28%|██▊       | 17/60 [04:45<10:46, 15.04s/it, v_num=1, train_loss_step=345, train_loss_epoch=315]  Epoch 18/60:  28%|██▊       | 17/60 [04:45<10:46, 15.04s/it, v_num=1, train_loss_step=345, train_loss_epoch=315]Epoch 18/60:  30%|███       | 18/60 [04:56<09:38, 13.78s/it, v_num=1, train_loss_step=345, train_loss_epoch=315]Epoch 18/60:  30%|███       | 18/60 [04:56<09:38, 13.78s/it, v_num=1, train_loss_step=430, train_loss_epoch=314]Epoch 19/60:  30%|███       | 18/60 [04:56<09:38, 13.78s/it, v_num=1, train_loss_step=430, train_loss_epoch=314]Epoch 19/60:  32%|███▏      | 19/60 [05:07<08:54, 13.03s/it, v_num=1, train_loss_step=430, train_loss_epoch=314]Epoch 19/60:  32%|███▏      | 19/60 [05:07<08:54, 13.03s/it, v_num=1, train_loss_step=253, train_loss_epoch=314]Epoch 20/60:  32%|███▏      | 19/60 [05:07<08:54, 13.03s/it, v_num=1, train_loss_step=253, train_loss_epoch=314]Epoch 20/60:  33%|███▎      | 20/60 [05:36<11:45, 17.65s/it, v_num=1, train_loss_step=253, train_loss_epoch=314]Epoch 20/60:  33%|███▎      | 20/60 [05:36<11:45, 17.65s/it, v_num=1, train_loss_step=240, train_loss_epoch=313]Epoch 21/60:  33%|███▎      | 20/60 [05:36<11:45, 17.65s/it, v_num=1, train_loss_step=240, train_loss_epoch=313]Epoch 21/60:  35%|███▌      | 21/60 [06:11<14:54, 22.93s/it, v_num=1, train_loss_step=240, train_loss_epoch=313]Epoch 21/60:  35%|███▌      | 21/60 [06:11<14:54, 22.93s/it, v_num=1, train_loss_step=197, train_loss_epoch=313]Epoch 22/60:  35%|███▌      | 21/60 [06:11<14:54, 22.93s/it, v_num=1, train_loss_step=197, train_loss_epoch=313]Epoch 22/60:  37%|███▋      | 22/60 [06:25<12:52, 20.34s/it, v_num=1, train_loss_step=197, train_loss_epoch=313]Epoch 22/60:  37%|███▋      | 22/60 [06:25<12:52, 20.34s/it, v_num=1, train_loss_step=353, train_loss_epoch=312]Epoch 23/60:  37%|███▋      | 22/60 [06:25<12:52, 20.34s/it, v_num=1, train_loss_step=353, train_loss_epoch=312]Epoch 23/60:  38%|███▊      | 23/60 [06:49<13:11, 21.39s/it, v_num=1, train_loss_step=353, train_loss_epoch=312]Epoch 23/60:  38%|███▊      | 23/60 [06:49<13:11, 21.39s/it, v_num=1, train_loss_step=79.8, train_loss_epoch=312]Epoch 24/60:  38%|███▊      | 23/60 [06:49<13:11, 21.39s/it, v_num=1, train_loss_step=79.8, train_loss_epoch=312]Epoch 24/60:  40%|████      | 24/60 [07:03<11:33, 19.27s/it, v_num=1, train_loss_step=79.8, train_loss_epoch=312]Epoch 24/60:  40%|████      | 24/60 [07:03<11:33, 19.27s/it, v_num=1, train_loss_step=505, train_loss_epoch=311] Epoch 25/60:  40%|████      | 24/60 [07:03<11:33, 19.27s/it, v_num=1, train_loss_step=505, train_loss_epoch=311]Epoch 25/60:  42%|████▏     | 25/60 [07:36<13:33, 23.23s/it, v_num=1, train_loss_step=505, train_loss_epoch=311]Epoch 25/60:  42%|████▏     | 25/60 [07:36<13:33, 23.23s/it, v_num=1, train_loss_step=365, train_loss_epoch=311]Epoch 26/60:  42%|████▏     | 25/60 [07:36<13:33, 23.23s/it, v_num=1, train_loss_step=365, train_loss_epoch=311]Epoch 26/60:  43%|████▎     | 26/60 [08:07<14:26, 25.48s/it, v_num=1, train_loss_step=365, train_loss_epoch=311]Epoch 26/60:  43%|████▎     | 26/60 [08:07<14:26, 25.48s/it, v_num=1, train_loss_step=322, train_loss_epoch=311]Epoch 27/60:  43%|████▎     | 26/60 [08:07<14:26, 25.48s/it, v_num=1, train_loss_step=322, train_loss_epoch=311]Epoch 27/60:  45%|████▌     | 27/60 [08:20<12:03, 21.91s/it, v_num=1, train_loss_step=322, train_loss_epoch=311]Epoch 27/60:  45%|████▌     | 27/60 [08:20<12:03, 21.91s/it, v_num=1, train_loss_step=282, train_loss_epoch=310]Epoch 28/60:  45%|████▌     | 27/60 [08:20<12:03, 21.91s/it, v_num=1, train_loss_step=282, train_loss_epoch=310]Epoch 28/60:  47%|████▋     | 28/60 [08:40<11:22, 21.32s/it, v_num=1, train_loss_step=282, train_loss_epoch=310]Epoch 28/60:  47%|████▋     | 28/60 [08:40<11:22, 21.32s/it, v_num=1, train_loss_step=0.283, train_loss_epoch=310]Epoch 29/60:  47%|████▋     | 28/60 [08:40<11:22, 21.32s/it, v_num=1, train_loss_step=0.283, train_loss_epoch=310]Epoch 29/60:  48%|████▊     | 29/60 [08:59<10:41, 20.69s/it, v_num=1, train_loss_step=0.283, train_loss_epoch=310]Epoch 29/60:  48%|████▊     | 29/60 [08:59<10:41, 20.69s/it, v_num=1, train_loss_step=485, train_loss_epoch=309]  Epoch 30/60:  48%|████▊     | 29/60 [08:59<10:41, 20.69s/it, v_num=1, train_loss_step=485, train_loss_epoch=309]Epoch 30/60:  50%|█████     | 30/60 [09:18<10:06, 20.20s/it, v_num=1, train_loss_step=485, train_loss_epoch=309]Epoch 30/60:  50%|█████     | 30/60 [09:18<10:06, 20.20s/it, v_num=1, train_loss_step=378, train_loss_epoch=310]Epoch 31/60:  50%|█████     | 30/60 [09:18<10:06, 20.20s/it, v_num=1, train_loss_step=378, train_loss_epoch=310]Epoch 31/60:  52%|█████▏    | 31/60 [09:29<08:23, 17.37s/it, v_num=1, train_loss_step=378, train_loss_epoch=310]Epoch 31/60:  52%|█████▏    | 31/60 [09:29<08:23, 17.37s/it, v_num=1, train_loss_step=0.315, train_loss_epoch=309]Epoch 32/60:  52%|█████▏    | 31/60 [09:29<08:23, 17.37s/it, v_num=1, train_loss_step=0.315, train_loss_epoch=309]Epoch 32/60:  53%|█████▎    | 32/60 [09:45<07:51, 16.85s/it, v_num=1, train_loss_step=0.315, train_loss_epoch=309]Epoch 32/60:  53%|█████▎    | 32/60 [09:45<07:51, 16.85s/it, v_num=1, train_loss_step=124, train_loss_epoch=308]  Epoch 33/60:  53%|█████▎    | 32/60 [09:45<07:51, 16.85s/it, v_num=1, train_loss_step=124, train_loss_epoch=308]Epoch 33/60:  55%|█████▌    | 33/60 [10:05<08:00, 17.78s/it, v_num=1, train_loss_step=124, train_loss_epoch=308]Epoch 33/60:  55%|█████▌    | 33/60 [10:05<08:00, 17.78s/it, v_num=1, train_loss_step=209, train_loss_epoch=308]Epoch 34/60:  55%|█████▌    | 33/60 [10:05<08:00, 17.78s/it, v_num=1, train_loss_step=209, train_loss_epoch=308]Epoch 34/60:  57%|█████▋    | 34/60 [11:09<13:47, 31.82s/it, v_num=1, train_loss_step=209, train_loss_epoch=308]Epoch 34/60:  57%|█████▋    | 34/60 [11:09<13:47, 31.82s/it, v_num=1, train_loss_step=202, train_loss_epoch=308]Epoch 35/60:  57%|█████▋    | 34/60 [11:09<13:47, 31.82s/it, v_num=1, train_loss_step=202, train_loss_epoch=308]Epoch 35/60:  58%|█████▊    | 35/60 [12:01<15:43, 37.74s/it, v_num=1, train_loss_step=202, train_loss_epoch=308]Epoch 35/60:  58%|█████▊    | 35/60 [12:01<15:43, 37.74s/it, v_num=1, train_loss_step=470, train_loss_epoch=308]Epoch 36/60:  58%|█████▊    | 35/60 [12:01<15:43, 37.74s/it, v_num=1, train_loss_step=470, train_loss_epoch=308]Epoch 36/60:  60%|██████    | 36/60 [12:15<12:17, 30.71s/it, v_num=1, train_loss_step=470, train_loss_epoch=308]Epoch 36/60:  60%|██████    | 36/60 [12:15<12:17, 30.71s/it, v_num=1, train_loss_step=1.26e+3, train_loss_epoch=308]Epoch 37/60:  60%|██████    | 36/60 [12:15<12:17, 30.71s/it, v_num=1, train_loss_step=1.26e+3, train_loss_epoch=308]Epoch 37/60:  62%|██████▏   | 37/60 [13:27<16:30, 43.08s/it, v_num=1, train_loss_step=1.26e+3, train_loss_epoch=308]Epoch 37/60:  62%|██████▏   | 37/60 [13:27<16:30, 43.08s/it, v_num=1, train_loss_step=205, train_loss_epoch=308]    Epoch 38/60:  62%|██████▏   | 37/60 [13:27<16:30, 43.08s/it, v_num=1, train_loss_step=205, train_loss_epoch=308]Epoch 38/60:  63%|██████▎   | 38/60 [14:01<14:49, 40.44s/it, v_num=1, train_loss_step=205, train_loss_epoch=308]Epoch 38/60:  63%|██████▎   | 38/60 [14:01<14:49, 40.44s/it, v_num=1, train_loss_step=0.359, train_loss_epoch=307]Epoch 39/60:  63%|██████▎   | 38/60 [14:01<14:49, 40.44s/it, v_num=1, train_loss_step=0.359, train_loss_epoch=307]Epoch 39/60:  65%|██████▌   | 39/60 [14:11<10:57, 31.32s/it, v_num=1, train_loss_step=0.359, train_loss_epoch=307]Epoch 39/60:  65%|██████▌   | 39/60 [14:11<10:57, 31.32s/it, v_num=1, train_loss_step=1.25e+3, train_loss_epoch=306]Epoch 40/60:  65%|██████▌   | 39/60 [14:11<10:57, 31.32s/it, v_num=1, train_loss_step=1.25e+3, train_loss_epoch=306]Epoch 40/60:  67%|██████▋   | 40/60 [14:51<11:15, 33.78s/it, v_num=1, train_loss_step=1.25e+3, train_loss_epoch=306]Epoch 40/60:  67%|██████▋   | 40/60 [14:51<11:15, 33.78s/it, v_num=1, train_loss_step=188, train_loss_epoch=306]    Epoch 41/60:  67%|██████▋   | 40/60 [14:51<11:15, 33.78s/it, v_num=1, train_loss_step=188, train_loss_epoch=306]Epoch 41/60:  68%|██████▊   | 41/60 [15:10<09:20, 29.49s/it, v_num=1, train_loss_step=188, train_loss_epoch=306]Epoch 41/60:  68%|██████▊   | 41/60 [15:10<09:20, 29.49s/it, v_num=1, train_loss_step=0.366, train_loss_epoch=306]Epoch 42/60:  68%|██████▊   | 41/60 [15:10<09:20, 29.49s/it, v_num=1, train_loss_step=0.366, train_loss_epoch=306]Epoch 42/60:  70%|███████   | 42/60 [15:21<07:07, 23.73s/it, v_num=1, train_loss_step=0.366, train_loss_epoch=306]Epoch 42/60:  70%|███████   | 42/60 [15:21<07:07, 23.73s/it, v_num=1, train_loss_step=426, train_loss_epoch=306]  Epoch 43/60:  70%|███████   | 42/60 [15:21<07:07, 23.73s/it, v_num=1, train_loss_step=426, train_loss_epoch=306]Epoch 43/60:  72%|███████▏  | 43/60 [15:32<05:39, 19.97s/it, v_num=1, train_loss_step=426, train_loss_epoch=306]Epoch 43/60:  72%|███████▏  | 43/60 [15:32<05:39, 19.97s/it, v_num=1, train_loss_step=162, train_loss_epoch=305]Epoch 44/60:  72%|███████▏  | 43/60 [15:32<05:39, 19.97s/it, v_num=1, train_loss_step=162, train_loss_epoch=305]Epoch 44/60:  73%|███████▎  | 44/60 [15:43<04:36, 17.30s/it, v_num=1, train_loss_step=162, train_loss_epoch=305]Epoch 44/60:  73%|███████▎  | 44/60 [15:43<04:36, 17.30s/it, v_num=1, train_loss_step=286, train_loss_epoch=305]Epoch 45/60:  73%|███████▎  | 44/60 [15:43<04:36, 17.30s/it, v_num=1, train_loss_step=286, train_loss_epoch=305]Epoch 45/60:  75%|███████▌  | 45/60 [15:54<03:50, 15.36s/it, v_num=1, train_loss_step=286, train_loss_epoch=305]Epoch 45/60:  75%|███████▌  | 45/60 [15:54<03:50, 15.36s/it, v_num=1, train_loss_step=108, train_loss_epoch=305]Epoch 46/60:  75%|███████▌  | 45/60 [15:54<03:50, 15.36s/it, v_num=1, train_loss_step=108, train_loss_epoch=305]Epoch 46/60:  77%|███████▋  | 46/60 [16:05<03:16, 14.01s/it, v_num=1, train_loss_step=108, train_loss_epoch=305]Epoch 46/60:  77%|███████▋  | 46/60 [16:05<03:16, 14.01s/it, v_num=1, train_loss_step=77.1, train_loss_epoch=304]Epoch 47/60:  77%|███████▋  | 46/60 [16:05<03:16, 14.01s/it, v_num=1, train_loss_step=77.1, train_loss_epoch=304]Epoch 47/60:  78%|███████▊  | 47/60 [16:19<03:04, 14.18s/it, v_num=1, train_loss_step=77.1, train_loss_epoch=304]Epoch 47/60:  78%|███████▊  | 47/60 [16:19<03:04, 14.18s/it, v_num=1, train_loss_step=782, train_loss_epoch=304] Epoch 48/60:  78%|███████▊  | 47/60 [16:19<03:04, 14.18s/it, v_num=1, train_loss_step=782, train_loss_epoch=304]Epoch 48/60:  80%|████████  | 48/60 [17:31<06:18, 31.53s/it, v_num=1, train_loss_step=782, train_loss_epoch=304]Epoch 48/60:  80%|████████  | 48/60 [17:31<06:18, 31.53s/it, v_num=1, train_loss_step=364, train_loss_epoch=304]Epoch 49/60:  80%|████████  | 48/60 [17:31<06:18, 31.53s/it, v_num=1, train_loss_step=364, train_loss_epoch=304]Epoch 49/60:  82%|████████▏ | 49/60 [17:42<04:37, 25.27s/it, v_num=1, train_loss_step=364, train_loss_epoch=304]Epoch 49/60:  82%|████████▏ | 49/60 [17:42<04:37, 25.27s/it, v_num=1, train_loss_step=0.399, train_loss_epoch=304]Epoch 50/60:  82%|████████▏ | 49/60 [17:42<04:37, 25.27s/it, v_num=1, train_loss_step=0.399, train_loss_epoch=304]Epoch 50/60:  83%|████████▎ | 50/60 [17:53<03:29, 20.91s/it, v_num=1, train_loss_step=0.399, train_loss_epoch=304]Epoch 50/60:  83%|████████▎ | 50/60 [17:53<03:29, 20.91s/it, v_num=1, train_loss_step=620, train_loss_epoch=303]  Epoch 51/60:  83%|████████▎ | 50/60 [17:53<03:29, 20.91s/it, v_num=1, train_loss_step=620, train_loss_epoch=303]Epoch 51/60:  85%|████████▌ | 51/60 [18:05<02:45, 18.44s/it, v_num=1, train_loss_step=620, train_loss_epoch=303]Epoch 51/60:  85%|████████▌ | 51/60 [18:05<02:45, 18.44s/it, v_num=1, train_loss_step=395, train_loss_epoch=303]Epoch 52/60:  85%|████████▌ | 51/60 [18:05<02:45, 18.44s/it, v_num=1, train_loss_step=395, train_loss_epoch=303]Epoch 52/60:  87%|████████▋ | 52/60 [18:23<02:25, 18.16s/it, v_num=1, train_loss_step=395, train_loss_epoch=303]Epoch 52/60:  87%|████████▋ | 52/60 [18:23<02:25, 18.16s/it, v_num=1, train_loss_step=411, train_loss_epoch=303]Epoch 53/60:  87%|████████▋ | 52/60 [18:23<02:25, 18.16s/it, v_num=1, train_loss_step=411, train_loss_epoch=303]Epoch 53/60:  88%|████████▊ | 53/60 [18:34<01:51, 15.93s/it, v_num=1, train_loss_step=411, train_loss_epoch=303]Epoch 53/60:  88%|████████▊ | 53/60 [18:34<01:51, 15.93s/it, v_num=1, train_loss_step=264, train_loss_epoch=303]Epoch 54/60:  88%|████████▊ | 53/60 [18:34<01:51, 15.93s/it, v_num=1, train_loss_step=264, train_loss_epoch=303]Epoch 54/60:  90%|█████████ | 54/60 [18:47<01:30, 15.14s/it, v_num=1, train_loss_step=264, train_loss_epoch=303]Epoch 54/60:  90%|█████████ | 54/60 [18:47<01:30, 15.14s/it, v_num=1, train_loss_step=303, train_loss_epoch=303]Epoch 55/60:  90%|█████████ | 54/60 [18:47<01:30, 15.14s/it, v_num=1, train_loss_step=303, train_loss_epoch=303]Epoch 55/60:  92%|█████████▏| 55/60 [19:22<01:44, 21.00s/it, v_num=1, train_loss_step=303, train_loss_epoch=303]Epoch 55/60:  92%|█████████▏| 55/60 [19:22<01:44, 21.00s/it, v_num=1, train_loss_step=166, train_loss_epoch=302]Epoch 56/60:  92%|█████████▏| 55/60 [19:22<01:44, 21.00s/it, v_num=1, train_loss_step=166, train_loss_epoch=302]Epoch 56/60:  93%|█████████▎| 56/60 [19:57<01:41, 25.27s/it, v_num=1, train_loss_step=166, train_loss_epoch=302]Epoch 56/60:  93%|█████████▎| 56/60 [19:57<01:41, 25.27s/it, v_num=1, train_loss_step=221, train_loss_epoch=302]Epoch 57/60:  93%|█████████▎| 56/60 [19:57<01:41, 25.27s/it, v_num=1, train_loss_step=221, train_loss_epoch=302]Epoch 57/60:  95%|█████████▌| 57/60 [20:59<01:48, 36.24s/it, v_num=1, train_loss_step=221, train_loss_epoch=302]Epoch 57/60:  95%|█████████▌| 57/60 [20:59<01:48, 36.24s/it, v_num=1, train_loss_step=395, train_loss_epoch=302]Epoch 58/60:  95%|█████████▌| 57/60 [20:59<01:48, 36.24s/it, v_num=1, train_loss_step=395, train_loss_epoch=302]Epoch 58/60:  97%|█████████▋| 58/60 [21:25<01:06, 33.19s/it, v_num=1, train_loss_step=395, train_loss_epoch=302]Epoch 58/60:  97%|█████████▋| 58/60 [21:25<01:06, 33.19s/it, v_num=1, train_loss_step=242, train_loss_epoch=302]Epoch 59/60:  97%|█████████▋| 58/60 [21:25<01:06, 33.19s/it, v_num=1, train_loss_step=242, train_loss_epoch=302]Epoch 59/60:  98%|█████████▊| 59/60 [21:55<00:32, 32.40s/it, v_num=1, train_loss_step=242, train_loss_epoch=302]Epoch 59/60:  98%|█████████▊| 59/60 [21:55<00:32, 32.40s/it, v_num=1, train_loss_step=630, train_loss_epoch=302]Epoch 60/60:  98%|█████████▊| 59/60 [21:55<00:32, 32.40s/it, v_num=1, train_loss_step=630, train_loss_epoch=302]Epoch 60/60: 100%|██████████| 60/60 [22:08<00:00, 26.45s/it, v_num=1, train_loss_step=630, train_loss_epoch=302]Epoch 60/60: 100%|██████████| 60/60 [22:08<00:00, 26.45s/it, v_num=1, train_loss_step=0.403, train_loss_epoch=303]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [22:08<00:00, 22.14s/it, v_num=1, train_loss_step=0.403, train_loss_epoch=303]2025-12-22 01:11:23,108 [INFO] Compare airspace scores after denoising
2025-12-22 01:11:24,418 [INFO] Writing summary of results to file
2025-12-22 01:11:24,421 [INFO] Plot scatter of correlation faceted by model
/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py:184: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series(pearsonr(g["AGTR1_scvi"], g["airspace_score"]),
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/seaborn/regression.py:598: UserWarning: legend_out is deprecated from the `lmplot` function signature. Please update your code to pass it using `facet_kws`.
  warnings.warn(msg, UserWarning)

Summary results saved to: airspace/agtr1_model_summary.txt
Saved melted correlation data to: airspace/pericytes_airspace_denoising.tsv
-----
anndata             0.11.4
matplotlib          3.10.5
numpy               1.26.4
pandas              2.3.2
scanpy              1.11.4
scipy               1.15.3
scvi                1.3.3
seaborn             0.13.2
session_info        v1.0.1
sklearn             1.7.2
statsmodels         0.14.5
-----
Python 3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]
Linux-4.18.0-553.22.1.el8_10.x86_64-x86_64-with-glibc2.28
-----
Session information updated at 2025-12-22 01:12
2025-12-22 01:12:44 - **** Job ends ****
