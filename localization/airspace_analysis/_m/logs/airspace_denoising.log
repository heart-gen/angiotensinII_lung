2025-12-20 12:40:08 - **** Job starts ****
2025-12-20 12:40:08 - **** Bridges-2 info ****
User: kbenjamin
Job id: 36640533
Job name: airspace_denoising
Node name: 
Hostname: r046
Task id: N/A

Currently Loaded Modules:
  1) anaconda3/2024.10-1   2) gcc/13.3.1-p20240614

 

2025-12-20 12:40:09 - **** Loading mamba environment ****
2025-12-20 12:40:09 - **** Run analysis ****
2025-12-20 12:46:50,139 [INFO] Define masks
2025-12-20 12:46:50,512 [INFO] Subset data for training: perivascular
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-20 12:47:11,276 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 10 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [01:40<1:39:04, 100.76s/it]Epoch 1/60:   2%|▏         | 1/60 [01:40<1:39:04, 100.76s/it, v_num=1, train_loss_step=245, train_loss_epoch=499]Epoch 2/60:   2%|▏         | 1/60 [01:40<1:39:04, 100.76s/it, v_num=1, train_loss_step=245, train_loss_epoch=499]Epoch 2/60:   3%|▎         | 2/60 [03:14<1:33:11, 96.41s/it, v_num=1, train_loss_step=245, train_loss_epoch=499] Epoch 2/60:   3%|▎         | 2/60 [03:14<1:33:11, 96.41s/it, v_num=1, train_loss_step=277, train_loss_epoch=460]Epoch 3/60:   3%|▎         | 2/60 [03:14<1:33:11, 96.41s/it, v_num=1, train_loss_step=277, train_loss_epoch=460]Epoch 3/60:   5%|▌         | 3/60 [04:40<1:27:05, 91.67s/it, v_num=1, train_loss_step=277, train_loss_epoch=460]Epoch 3/60:   5%|▌         | 3/60 [04:40<1:27:05, 91.67s/it, v_num=1, train_loss_step=682, train_loss_epoch=453]Epoch 4/60:   5%|▌         | 3/60 [04:40<1:27:05, 91.67s/it, v_num=1, train_loss_step=682, train_loss_epoch=453]Epoch 4/60:   7%|▋         | 4/60 [06:23<1:29:44, 96.15s/it, v_num=1, train_loss_step=682, train_loss_epoch=453]Epoch 4/60:   7%|▋         | 4/60 [06:23<1:29:44, 96.15s/it, v_num=1, train_loss_step=493, train_loss_epoch=448]Epoch 5/60:   7%|▋         | 4/60 [06:23<1:29:44, 96.15s/it, v_num=1, train_loss_step=493, train_loss_epoch=448]Epoch 5/60:   8%|▊         | 5/60 [08:04<1:29:53, 98.06s/it, v_num=1, train_loss_step=493, train_loss_epoch=448]Epoch 5/60:   8%|▊         | 5/60 [08:04<1:29:53, 98.06s/it, v_num=1, train_loss_step=229, train_loss_epoch=445]Epoch 6/60:   8%|▊         | 5/60 [08:04<1:29:53, 98.06s/it, v_num=1, train_loss_step=229, train_loss_epoch=445]Epoch 6/60:  10%|█         | 6/60 [09:35<1:26:04, 95.64s/it, v_num=1, train_loss_step=229, train_loss_epoch=445]Epoch 6/60:  10%|█         | 6/60 [09:35<1:26:04, 95.64s/it, v_num=1, train_loss_step=677, train_loss_epoch=443]Epoch 7/60:  10%|█         | 6/60 [09:35<1:26:04, 95.64s/it, v_num=1, train_loss_step=677, train_loss_epoch=443]Epoch 7/60:  12%|█▏        | 7/60 [11:12<1:24:59, 96.22s/it, v_num=1, train_loss_step=677, train_loss_epoch=443]Epoch 7/60:  12%|█▏        | 7/60 [11:12<1:24:59, 96.22s/it, v_num=1, train_loss_step=483, train_loss_epoch=441]Epoch 8/60:  12%|█▏        | 7/60 [11:12<1:24:59, 96.22s/it, v_num=1, train_loss_step=483, train_loss_epoch=441]Epoch 8/60:  13%|█▎        | 8/60 [12:49<1:23:31, 96.37s/it, v_num=1, train_loss_step=483, train_loss_epoch=441]Epoch 8/60:  13%|█▎        | 8/60 [12:49<1:23:31, 96.37s/it, v_num=1, train_loss_step=479, train_loss_epoch=440]Epoch 9/60:  13%|█▎        | 8/60 [12:49<1:23:31, 96.37s/it, v_num=1, train_loss_step=479, train_loss_epoch=440]Epoch 9/60:  15%|█▌        | 9/60 [14:29<1:22:54, 97.53s/it, v_num=1, train_loss_step=479, train_loss_epoch=440]Epoch 9/60:  15%|█▌        | 9/60 [14:29<1:22:54, 97.53s/it, v_num=1, train_loss_step=140, train_loss_epoch=438]Epoch 10/60:  15%|█▌        | 9/60 [14:29<1:22:54, 97.53s/it, v_num=1, train_loss_step=140, train_loss_epoch=438]Epoch 10/60:  17%|█▋        | 10/60 [16:36<1:28:41, 106.44s/it, v_num=1, train_loss_step=140, train_loss_epoch=438]Epoch 10/60:  17%|█▋        | 10/60 [16:36<1:28:41, 106.44s/it, v_num=1, train_loss_step=337, train_loss_epoch=438]Epoch 11/60:  17%|█▋        | 10/60 [16:36<1:28:41, 106.44s/it, v_num=1, train_loss_step=337, train_loss_epoch=438]Epoch 11/60:  18%|█▊        | 11/60 [18:15<1:25:09, 104.28s/it, v_num=1, train_loss_step=337, train_loss_epoch=438]Epoch 11/60:  18%|█▊        | 11/60 [18:15<1:25:09, 104.28s/it, v_num=1, train_loss_step=496, train_loss_epoch=437]Epoch 12/60:  18%|█▊        | 11/60 [18:15<1:25:09, 104.28s/it, v_num=1, train_loss_step=496, train_loss_epoch=437]Epoch 12/60:  20%|██        | 12/60 [19:54<1:22:05, 102.61s/it, v_num=1, train_loss_step=496, train_loss_epoch=437]Epoch 12/60:  20%|██        | 12/60 [19:54<1:22:05, 102.61s/it, v_num=1, train_loss_step=482, train_loss_epoch=436]Epoch 13/60:  20%|██        | 12/60 [19:54<1:22:05, 102.61s/it, v_num=1, train_loss_step=482, train_loss_epoch=436]Epoch 13/60:  22%|██▏       | 13/60 [21:35<1:19:56, 102.06s/it, v_num=1, train_loss_step=482, train_loss_epoch=436]Epoch 13/60:  22%|██▏       | 13/60 [21:35<1:19:56, 102.06s/it, v_num=1, train_loss_step=395, train_loss_epoch=436]Epoch 14/60:  22%|██▏       | 13/60 [21:35<1:19:56, 102.06s/it, v_num=1, train_loss_step=395, train_loss_epoch=436]Epoch 14/60:  23%|██▎       | 14/60 [23:07<1:16:03, 99.20s/it, v_num=1, train_loss_step=395, train_loss_epoch=436] Epoch 14/60:  23%|██▎       | 14/60 [23:07<1:16:03, 99.20s/it, v_num=1, train_loss_step=1.02e+3, train_loss_epoch=435]Epoch 15/60:  23%|██▎       | 14/60 [23:07<1:16:03, 99.20s/it, v_num=1, train_loss_step=1.02e+3, train_loss_epoch=435]Epoch 15/60:  25%|██▌       | 15/60 [24:45<1:14:01, 98.71s/it, v_num=1, train_loss_step=1.02e+3, train_loss_epoch=435]Epoch 15/60:  25%|██▌       | 15/60 [24:45<1:14:01, 98.71s/it, v_num=1, train_loss_step=160, train_loss_epoch=435]    Epoch 16/60:  25%|██▌       | 15/60 [24:45<1:14:01, 98.71s/it, v_num=1, train_loss_step=160, train_loss_epoch=435]Epoch 16/60:  27%|██▋       | 16/60 [26:16<1:10:44, 96.47s/it, v_num=1, train_loss_step=160, train_loss_epoch=435]Epoch 16/60:  27%|██▋       | 16/60 [26:16<1:10:44, 96.47s/it, v_num=1, train_loss_step=198, train_loss_epoch=434]Epoch 17/60:  27%|██▋       | 16/60 [26:16<1:10:44, 96.47s/it, v_num=1, train_loss_step=198, train_loss_epoch=434]Epoch 17/60:  28%|██▊       | 17/60 [27:55<1:09:36, 97.12s/it, v_num=1, train_loss_step=198, train_loss_epoch=434]Epoch 17/60:  28%|██▊       | 17/60 [27:55<1:09:36, 97.12s/it, v_num=1, train_loss_step=612, train_loss_epoch=434]Epoch 18/60:  28%|██▊       | 17/60 [27:55<1:09:36, 97.12s/it, v_num=1, train_loss_step=612, train_loss_epoch=434]Epoch 18/60:  30%|███       | 18/60 [29:27<1:06:52, 95.53s/it, v_num=1, train_loss_step=612, train_loss_epoch=434]Epoch 18/60:  30%|███       | 18/60 [29:27<1:06:52, 95.53s/it, v_num=1, train_loss_step=342, train_loss_epoch=434]Epoch 19/60:  30%|███       | 18/60 [29:27<1:06:52, 95.53s/it, v_num=1, train_loss_step=342, train_loss_epoch=434]Epoch 19/60:  32%|███▏      | 19/60 [30:57<1:04:15, 94.04s/it, v_num=1, train_loss_step=342, train_loss_epoch=434]Epoch 19/60:  32%|███▏      | 19/60 [30:57<1:04:15, 94.04s/it, v_num=1, train_loss_step=459, train_loss_epoch=433]Epoch 20/60:  32%|███▏      | 19/60 [30:57<1:04:15, 94.04s/it, v_num=1, train_loss_step=459, train_loss_epoch=433]Epoch 20/60:  33%|███▎      | 20/60 [32:36<1:03:42, 95.57s/it, v_num=1, train_loss_step=459, train_loss_epoch=433]Epoch 20/60:  33%|███▎      | 20/60 [32:36<1:03:42, 95.57s/it, v_num=1, train_loss_step=666, train_loss_epoch=433]Epoch 21/60:  33%|███▎      | 20/60 [32:36<1:03:42, 95.57s/it, v_num=1, train_loss_step=666, train_loss_epoch=433]Epoch 21/60:  35%|███▌      | 21/60 [34:14<1:02:27, 96.10s/it, v_num=1, train_loss_step=666, train_loss_epoch=433]Epoch 21/60:  35%|███▌      | 21/60 [34:14<1:02:27, 96.10s/it, v_num=1, train_loss_step=142, train_loss_epoch=433]Epoch 22/60:  35%|███▌      | 21/60 [34:14<1:02:27, 96.10s/it, v_num=1, train_loss_step=142, train_loss_epoch=433]Epoch 22/60:  37%|███▋      | 22/60 [35:53<1:01:31, 97.15s/it, v_num=1, train_loss_step=142, train_loss_epoch=433]Epoch 22/60:  37%|███▋      | 22/60 [35:53<1:01:31, 97.15s/it, v_num=1, train_loss_step=257, train_loss_epoch=432]Epoch 23/60:  37%|███▋      | 22/60 [35:53<1:01:31, 97.15s/it, v_num=1, train_loss_step=257, train_loss_epoch=432]Epoch 23/60:  38%|███▊      | 23/60 [37:33<1:00:28, 98.06s/it, v_num=1, train_loss_step=257, train_loss_epoch=432]Epoch 23/60:  38%|███▊      | 23/60 [37:33<1:00:28, 98.06s/it, v_num=1, train_loss_step=319, train_loss_epoch=432]Epoch 24/60:  38%|███▊      | 23/60 [37:33<1:00:28, 98.06s/it, v_num=1, train_loss_step=319, train_loss_epoch=432]Epoch 24/60:  40%|████      | 24/60 [39:15<59:32, 99.23s/it, v_num=1, train_loss_step=319, train_loss_epoch=432]  Epoch 24/60:  40%|████      | 24/60 [39:15<59:32, 99.23s/it, v_num=1, train_loss_step=874, train_loss_epoch=432]Epoch 25/60:  40%|████      | 24/60 [39:15<59:32, 99.23s/it, v_num=1, train_loss_step=874, train_loss_epoch=432]Epoch 25/60:  42%|████▏     | 25/60 [40:52<57:24, 98.41s/it, v_num=1, train_loss_step=874, train_loss_epoch=432]Epoch 25/60:  42%|████▏     | 25/60 [40:52<57:24, 98.41s/it, v_num=1, train_loss_step=698, train_loss_epoch=432]Epoch 26/60:  42%|████▏     | 25/60 [40:52<57:24, 98.41s/it, v_num=1, train_loss_step=698, train_loss_epoch=432]Epoch 26/60:  43%|████▎     | 26/60 [42:29<55:31, 98.00s/it, v_num=1, train_loss_step=698, train_loss_epoch=432]Epoch 26/60:  43%|████▎     | 26/60 [42:29<55:31, 98.00s/it, v_num=1, train_loss_step=629, train_loss_epoch=432]Epoch 27/60:  43%|████▎     | 26/60 [42:29<55:31, 98.00s/it, v_num=1, train_loss_step=629, train_loss_epoch=432]Epoch 27/60:  45%|████▌     | 27/60 [44:05<53:36, 97.46s/it, v_num=1, train_loss_step=629, train_loss_epoch=432]Epoch 27/60:  45%|████▌     | 27/60 [44:05<53:36, 97.46s/it, v_num=1, train_loss_step=603, train_loss_epoch=431]Epoch 28/60:  45%|████▌     | 27/60 [44:05<53:36, 97.46s/it, v_num=1, train_loss_step=603, train_loss_epoch=431]Epoch 28/60:  47%|████▋     | 28/60 [46:15<57:14, 107.32s/it, v_num=1, train_loss_step=603, train_loss_epoch=431]Epoch 28/60:  47%|████▋     | 28/60 [46:15<57:14, 107.32s/it, v_num=1, train_loss_step=557, train_loss_epoch=431]Epoch 29/60:  47%|████▋     | 28/60 [46:15<57:14, 107.32s/it, v_num=1, train_loss_step=557, train_loss_epoch=431]Epoch 29/60:  48%|████▊     | 29/60 [47:52<53:51, 104.23s/it, v_num=1, train_loss_step=557, train_loss_epoch=431]Epoch 29/60:  48%|████▊     | 29/60 [47:52<53:51, 104.23s/it, v_num=1, train_loss_step=941, train_loss_epoch=431]Epoch 30/60:  48%|████▊     | 29/60 [47:52<53:51, 104.23s/it, v_num=1, train_loss_step=941, train_loss_epoch=431]Epoch 30/60:  50%|█████     | 30/60 [49:31<51:18, 102.61s/it, v_num=1, train_loss_step=941, train_loss_epoch=431]Epoch 30/60:  50%|█████     | 30/60 [49:31<51:18, 102.61s/it, v_num=1, train_loss_step=643, train_loss_epoch=431]Epoch 31/60:  50%|█████     | 30/60 [49:31<51:18, 102.61s/it, v_num=1, train_loss_step=643, train_loss_epoch=431]Epoch 31/60:  52%|█████▏    | 31/60 [51:10<49:04, 101.53s/it, v_num=1, train_loss_step=643, train_loss_epoch=431]Epoch 31/60:  52%|█████▏    | 31/60 [51:10<49:04, 101.53s/it, v_num=1, train_loss_step=482, train_loss_epoch=431]Epoch 32/60:  52%|█████▏    | 31/60 [51:10<49:04, 101.53s/it, v_num=1, train_loss_step=482, train_loss_epoch=431]Epoch 32/60:  53%|█████▎    | 32/60 [52:49<46:59, 100.70s/it, v_num=1, train_loss_step=482, train_loss_epoch=431]Epoch 32/60:  53%|█████▎    | 32/60 [52:49<46:59, 100.70s/it, v_num=1, train_loss_step=279, train_loss_epoch=431]Epoch 33/60:  53%|█████▎    | 32/60 [52:49<46:59, 100.70s/it, v_num=1, train_loss_step=279, train_loss_epoch=431]Epoch 33/60:  55%|█████▌    | 33/60 [54:29<45:14, 100.55s/it, v_num=1, train_loss_step=279, train_loss_epoch=431]Epoch 33/60:  55%|█████▌    | 33/60 [54:29<45:14, 100.55s/it, v_num=1, train_loss_step=923, train_loss_epoch=431]Epoch 34/60:  55%|█████▌    | 33/60 [54:29<45:14, 100.55s/it, v_num=1, train_loss_step=923, train_loss_epoch=431]Epoch 34/60:  57%|█████▋    | 34/60 [56:08<43:22, 100.11s/it, v_num=1, train_loss_step=923, train_loss_epoch=431]Epoch 34/60:  57%|█████▋    | 34/60 [56:08<43:22, 100.11s/it, v_num=1, train_loss_step=80.1, train_loss_epoch=430]Epoch 35/60:  57%|█████▋    | 34/60 [56:08<43:22, 100.11s/it, v_num=1, train_loss_step=80.1, train_loss_epoch=430]Epoch 35/60:  58%|█████▊    | 35/60 [57:47<41:31, 99.64s/it, v_num=1, train_loss_step=80.1, train_loss_epoch=430] Epoch 35/60:  58%|█████▊    | 35/60 [57:47<41:31, 99.64s/it, v_num=1, train_loss_step=441, train_loss_epoch=430] Epoch 36/60:  58%|█████▊    | 35/60 [57:47<41:31, 99.64s/it, v_num=1, train_loss_step=441, train_loss_epoch=430]Epoch 36/60:  60%|██████    | 36/60 [59:27<39:56, 99.87s/it, v_num=1, train_loss_step=441, train_loss_epoch=430]Epoch 36/60:  60%|██████    | 36/60 [59:27<39:56, 99.87s/it, v_num=1, train_loss_step=567, train_loss_epoch=430]Epoch 37/60:  60%|██████    | 36/60 [59:27<39:56, 99.87s/it, v_num=1, train_loss_step=567, train_loss_epoch=430]Epoch 37/60:  62%|██████▏   | 37/60 [1:01:07<38:15, 99.82s/it, v_num=1, train_loss_step=567, train_loss_epoch=430]Epoch 37/60:  62%|██████▏   | 37/60 [1:01:07<38:15, 99.82s/it, v_num=1, train_loss_step=349, train_loss_epoch=430]Epoch 38/60:  62%|██████▏   | 37/60 [1:01:07<38:15, 99.82s/it, v_num=1, train_loss_step=349, train_loss_epoch=430]Epoch 38/60:  63%|██████▎   | 38/60 [1:02:49<36:52, 100.57s/it, v_num=1, train_loss_step=349, train_loss_epoch=430]Epoch 38/60:  63%|██████▎   | 38/60 [1:02:49<36:52, 100.57s/it, v_num=1, train_loss_step=404, train_loss_epoch=430]Epoch 39/60:  63%|██████▎   | 38/60 [1:02:49<36:52, 100.57s/it, v_num=1, train_loss_step=404, train_loss_epoch=430]Epoch 39/60:  65%|██████▌   | 39/60 [1:04:36<35:50, 102.41s/it, v_num=1, train_loss_step=404, train_loss_epoch=430]Epoch 39/60:  65%|██████▌   | 39/60 [1:04:36<35:50, 102.41s/it, v_num=1, train_loss_step=635, train_loss_epoch=430]Epoch 40/60:  65%|██████▌   | 39/60 [1:04:36<35:50, 102.41s/it, v_num=1, train_loss_step=635, train_loss_epoch=430]Epoch 40/60:  67%|██████▋   | 40/60 [1:06:23<34:38, 103.91s/it, v_num=1, train_loss_step=635, train_loss_epoch=430]Epoch 40/60:  67%|██████▋   | 40/60 [1:06:23<34:38, 103.91s/it, v_num=1, train_loss_step=341, train_loss_epoch=430]Epoch 41/60:  67%|██████▋   | 40/60 [1:06:24<34:38, 103.91s/it, v_num=1, train_loss_step=341, train_loss_epoch=430]Epoch 41/60:  68%|██████▊   | 41/60 [1:08:03<32:32, 102.77s/it, v_num=1, train_loss_step=341, train_loss_epoch=430]Epoch 41/60:  68%|██████▊   | 41/60 [1:08:03<32:32, 102.77s/it, v_num=1, train_loss_step=436, train_loss_epoch=430]Epoch 42/60:  68%|██████▊   | 41/60 [1:08:04<32:32, 102.77s/it, v_num=1, train_loss_step=436, train_loss_epoch=430]Epoch 42/60:  70%|███████   | 42/60 [1:09:44<30:37, 102.11s/it, v_num=1, train_loss_step=436, train_loss_epoch=430]Epoch 42/60:  70%|███████   | 42/60 [1:09:44<30:37, 102.11s/it, v_num=1, train_loss_step=476, train_loss_epoch=430]Epoch 43/60:  70%|███████   | 42/60 [1:09:44<30:37, 102.11s/it, v_num=1, train_loss_step=476, train_loss_epoch=430]Epoch 43/60:  72%|███████▏  | 43/60 [1:11:24<28:44, 101.44s/it, v_num=1, train_loss_step=476, train_loss_epoch=430]Epoch 43/60:  72%|███████▏  | 43/60 [1:11:24<28:44, 101.44s/it, v_num=1, train_loss_step=331, train_loss_epoch=430]Epoch 44/60:  72%|███████▏  | 43/60 [1:11:24<28:44, 101.44s/it, v_num=1, train_loss_step=331, train_loss_epoch=430]Epoch 44/60:  73%|███████▎  | 44/60 [1:13:10<27:23, 102.73s/it, v_num=1, train_loss_step=331, train_loss_epoch=430]Epoch 44/60:  73%|███████▎  | 44/60 [1:13:10<27:23, 102.73s/it, v_num=1, train_loss_step=505, train_loss_epoch=429]Epoch 45/60:  73%|███████▎  | 44/60 [1:13:10<27:23, 102.73s/it, v_num=1, train_loss_step=505, train_loss_epoch=429]Epoch 45/60:  75%|███████▌  | 45/60 [1:14:58<26:04, 104.32s/it, v_num=1, train_loss_step=505, train_loss_epoch=429]Epoch 45/60:  75%|███████▌  | 45/60 [1:14:58<26:04, 104.32s/it, v_num=1, train_loss_step=269, train_loss_epoch=429]Epoch 46/60:  75%|███████▌  | 45/60 [1:14:58<26:04, 104.32s/it, v_num=1, train_loss_step=269, train_loss_epoch=429]Epoch 46/60:  77%|███████▋  | 46/60 [1:17:08<26:10, 112.19s/it, v_num=1, train_loss_step=269, train_loss_epoch=429]Epoch 46/60:  77%|███████▋  | 46/60 [1:17:08<26:10, 112.19s/it, v_num=1, train_loss_step=127, train_loss_epoch=429]Epoch 47/60:  77%|███████▋  | 46/60 [1:17:08<26:10, 112.19s/it, v_num=1, train_loss_step=127, train_loss_epoch=429]Epoch 47/60:  78%|███████▊  | 47/60 [1:18:47<23:26, 108.16s/it, v_num=1, train_loss_step=127, train_loss_epoch=429]Epoch 47/60:  78%|███████▊  | 47/60 [1:18:47<23:26, 108.16s/it, v_num=1, train_loss_step=358, train_loss_epoch=429]Epoch 48/60:  78%|███████▊  | 47/60 [1:18:47<23:26, 108.16s/it, v_num=1, train_loss_step=358, train_loss_epoch=429]Epoch 48/60:  80%|████████  | 48/60 [1:20:25<21:02, 105.17s/it, v_num=1, train_loss_step=358, train_loss_epoch=429]Epoch 48/60:  80%|████████  | 48/60 [1:20:25<21:02, 105.17s/it, v_num=1, train_loss_step=272, train_loss_epoch=429]Epoch 49/60:  80%|████████  | 48/60 [1:20:25<21:02, 105.17s/it, v_num=1, train_loss_step=272, train_loss_epoch=429]Epoch 49/60:  82%|████████▏ | 49/60 [1:22:04<18:57, 103.38s/it, v_num=1, train_loss_step=272, train_loss_epoch=429]Epoch 49/60:  82%|████████▏ | 49/60 [1:22:04<18:57, 103.38s/it, v_num=1, train_loss_step=362, train_loss_epoch=429]Epoch 50/60:  82%|████████▏ | 49/60 [1:22:04<18:57, 103.38s/it, v_num=1, train_loss_step=362, train_loss_epoch=429]Epoch 50/60:  83%|████████▎ | 50/60 [1:23:43<16:58, 101.88s/it, v_num=1, train_loss_step=362, train_loss_epoch=429]Epoch 50/60:  83%|████████▎ | 50/60 [1:23:43<16:58, 101.88s/it, v_num=1, train_loss_step=310, train_loss_epoch=429]Epoch 51/60:  83%|████████▎ | 50/60 [1:23:43<16:58, 101.88s/it, v_num=1, train_loss_step=310, train_loss_epoch=429]Epoch 51/60:  85%|████████▌ | 51/60 [1:25:24<15:16, 101.83s/it, v_num=1, train_loss_step=310, train_loss_epoch=429]Epoch 51/60:  85%|████████▌ | 51/60 [1:25:24<15:16, 101.83s/it, v_num=1, train_loss_step=205, train_loss_epoch=429]Epoch 52/60:  85%|████████▌ | 51/60 [1:25:24<15:16, 101.83s/it, v_num=1, train_loss_step=205, train_loss_epoch=429]Epoch 52/60:  87%|████████▋ | 52/60 [1:27:05<13:31, 101.38s/it, v_num=1, train_loss_step=205, train_loss_epoch=429]Epoch 52/60:  87%|████████▋ | 52/60 [1:27:05<13:31, 101.38s/it, v_num=1, train_loss_step=979, train_loss_epoch=429]Epoch 53/60:  87%|████████▋ | 52/60 [1:27:05<13:31, 101.38s/it, v_num=1, train_loss_step=979, train_loss_epoch=429]Epoch 53/60:  88%|████████▊ | 53/60 [1:28:44<11:45, 100.78s/it, v_num=1, train_loss_step=979, train_loss_epoch=429]Epoch 53/60:  88%|████████▊ | 53/60 [1:28:44<11:45, 100.78s/it, v_num=1, train_loss_step=523, train_loss_epoch=429]Epoch 54/60:  88%|████████▊ | 53/60 [1:28:44<11:45, 100.78s/it, v_num=1, train_loss_step=523, train_loss_epoch=429]Epoch 54/60:  90%|█████████ | 54/60 [1:30:24<10:03, 100.62s/it, v_num=1, train_loss_step=523, train_loss_epoch=429]Epoch 54/60:  90%|█████████ | 54/60 [1:30:24<10:03, 100.62s/it, v_num=1, train_loss_step=806, train_loss_epoch=429]Epoch 55/60:  90%|█████████ | 54/60 [1:30:24<10:03, 100.62s/it, v_num=1, train_loss_step=806, train_loss_epoch=429]Epoch 55/60:  92%|█████████▏| 55/60 [1:32:05<08:23, 100.66s/it, v_num=1, train_loss_step=806, train_loss_epoch=429]Epoch 55/60:  92%|█████████▏| 55/60 [1:32:05<08:23, 100.66s/it, v_num=1, train_loss_step=320, train_loss_epoch=429]Epoch 56/60:  92%|█████████▏| 55/60 [1:32:05<08:23, 100.66s/it, v_num=1, train_loss_step=320, train_loss_epoch=429]Epoch 56/60:  93%|█████████▎| 56/60 [1:33:45<06:41, 100.26s/it, v_num=1, train_loss_step=320, train_loss_epoch=429]Epoch 56/60:  93%|█████████▎| 56/60 [1:33:45<06:41, 100.26s/it, v_num=1, train_loss_step=856, train_loss_epoch=429]Epoch 57/60:  93%|█████████▎| 56/60 [1:33:45<06:41, 100.26s/it, v_num=1, train_loss_step=856, train_loss_epoch=429]Epoch 57/60:  95%|█████████▌| 57/60 [1:35:23<04:59, 99.72s/it, v_num=1, train_loss_step=856, train_loss_epoch=429] Epoch 57/60:  95%|█████████▌| 57/60 [1:35:23<04:59, 99.72s/it, v_num=1, train_loss_step=277, train_loss_epoch=429]Epoch 58/60:  95%|█████████▌| 57/60 [1:35:23<04:59, 99.72s/it, v_num=1, train_loss_step=277, train_loss_epoch=429]Epoch 58/60:  97%|█████████▋| 58/60 [1:37:04<03:20, 100.25s/it, v_num=1, train_loss_step=277, train_loss_epoch=429]Epoch 58/60:  97%|█████████▋| 58/60 [1:37:04<03:20, 100.25s/it, v_num=1, train_loss_step=384, train_loss_epoch=428]Epoch 59/60:  97%|█████████▋| 58/60 [1:37:04<03:20, 100.25s/it, v_num=1, train_loss_step=384, train_loss_epoch=428]Epoch 59/60:  98%|█████████▊| 59/60 [1:38:44<01:39, 99.90s/it, v_num=1, train_loss_step=384, train_loss_epoch=428] Epoch 59/60:  98%|█████████▊| 59/60 [1:38:44<01:39, 99.90s/it, v_num=1, train_loss_step=652, train_loss_epoch=428]Epoch 60/60:  98%|█████████▊| 59/60 [1:38:44<01:39, 99.90s/it, v_num=1, train_loss_step=652, train_loss_epoch=428]Epoch 60/60: 100%|██████████| 60/60 [1:40:18<00:00, 98.39s/it, v_num=1, train_loss_step=652, train_loss_epoch=428]Epoch 60/60: 100%|██████████| 60/60 [1:40:18<00:00, 98.39s/it, v_num=1, train_loss_step=274, train_loss_epoch=428]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [1:40:18<00:00, 100.32s/it, v_num=1, train_loss_step=274, train_loss_epoch=428]2025-12-20 14:28:05,758 [INFO] Subset data for training: pericytes
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scanpy/preprocessing/_highly_variable_genes.py:693: UserWarning: `n_top_genes` > number of normalized dispersions, returning all genes with normalized dispersions.
  df = _highly_variable_genes_batched(
2025-12-20 14:28:09,430 [INFO] Training scVI model on perivascular cells
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scvi/data/fields/_dataframe_field.py:187: UserWarning: Category 4 in adata.obs['_scvi_batch'] has fewer than 3 cells. Models may not train properly.
  categorical_mapping = _make_column_categorical(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
SLURM auto-requeueing enabled. Setting signal handlers.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.
/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=63` in the `DataLoader` to improve performance.

Training:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   0%|          | 0/60 [00:00<?, ?it/s]Epoch 1/60:   2%|▏         | 1/60 [00:09<09:49,  9.99s/it]Epoch 1/60:   2%|▏         | 1/60 [00:09<09:49,  9.99s/it, v_num=1, train_loss_step=299, train_loss_epoch=457]Epoch 2/60:   2%|▏         | 1/60 [00:09<09:49,  9.99s/it, v_num=1, train_loss_step=299, train_loss_epoch=457]Epoch 2/60:   3%|▎         | 2/60 [00:19<09:30,  9.84s/it, v_num=1, train_loss_step=299, train_loss_epoch=457]Epoch 2/60:   3%|▎         | 2/60 [00:19<09:30,  9.84s/it, v_num=1, train_loss_step=394, train_loss_epoch=338]Epoch 3/60:   3%|▎         | 2/60 [00:19<09:30,  9.84s/it, v_num=1, train_loss_step=394, train_loss_epoch=338]Epoch 3/60:   5%|▌         | 3/60 [00:30<09:37, 10.13s/it, v_num=1, train_loss_step=394, train_loss_epoch=338]Epoch 3/60:   5%|▌         | 3/60 [00:30<09:37, 10.13s/it, v_num=1, train_loss_step=480, train_loss_epoch=331]Epoch 4/60:   5%|▌         | 3/60 [00:30<09:37, 10.13s/it, v_num=1, train_loss_step=480, train_loss_epoch=331]Epoch 4/60:   7%|▋         | 4/60 [00:39<09:12,  9.87s/it, v_num=1, train_loss_step=480, train_loss_epoch=331]Epoch 4/60:   7%|▋         | 4/60 [00:39<09:12,  9.87s/it, v_num=1, train_loss_step=425, train_loss_epoch=327]Epoch 5/60:   7%|▋         | 4/60 [00:39<09:12,  9.87s/it, v_num=1, train_loss_step=425, train_loss_epoch=327]Epoch 5/60:   8%|▊         | 5/60 [00:49<09:02,  9.86s/it, v_num=1, train_loss_step=425, train_loss_epoch=327]Epoch 5/60:   8%|▊         | 5/60 [00:49<09:02,  9.86s/it, v_num=1, train_loss_step=0.00485, train_loss_epoch=324]Epoch 6/60:   8%|▊         | 5/60 [00:49<09:02,  9.86s/it, v_num=1, train_loss_step=0.00485, train_loss_epoch=324]Epoch 6/60:  10%|█         | 6/60 [00:59<08:58,  9.97s/it, v_num=1, train_loss_step=0.00485, train_loss_epoch=324]Epoch 6/60:  10%|█         | 6/60 [00:59<08:58,  9.97s/it, v_num=1, train_loss_step=124, train_loss_epoch=322]    Epoch 7/60:  10%|█         | 6/60 [00:59<08:58,  9.97s/it, v_num=1, train_loss_step=124, train_loss_epoch=322]Epoch 7/60:  12%|█▏        | 7/60 [01:08<08:20,  9.45s/it, v_num=1, train_loss_step=124, train_loss_epoch=322]Epoch 7/60:  12%|█▏        | 7/60 [01:08<08:20,  9.45s/it, v_num=1, train_loss_step=212, train_loss_epoch=321]Epoch 8/60:  12%|█▏        | 7/60 [01:08<08:20,  9.45s/it, v_num=1, train_loss_step=212, train_loss_epoch=321]Epoch 8/60:  13%|█▎        | 8/60 [01:16<07:53,  9.10s/it, v_num=1, train_loss_step=212, train_loss_epoch=321]Epoch 8/60:  13%|█▎        | 8/60 [01:16<07:53,  9.10s/it, v_num=1, train_loss_step=0.00188, train_loss_epoch=320]Epoch 9/60:  13%|█▎        | 8/60 [01:16<07:53,  9.10s/it, v_num=1, train_loss_step=0.00188, train_loss_epoch=320]Epoch 9/60:  15%|█▌        | 9/60 [01:25<07:39,  9.01s/it, v_num=1, train_loss_step=0.00188, train_loss_epoch=320]Epoch 9/60:  15%|█▌        | 9/60 [01:25<07:39,  9.01s/it, v_num=1, train_loss_step=403, train_loss_epoch=319]    Epoch 10/60:  15%|█▌        | 9/60 [01:25<07:39,  9.01s/it, v_num=1, train_loss_step=403, train_loss_epoch=319]Epoch 10/60:  17%|█▋        | 10/60 [01:34<07:34,  9.08s/it, v_num=1, train_loss_step=403, train_loss_epoch=319]Epoch 10/60:  17%|█▋        | 10/60 [01:34<07:34,  9.08s/it, v_num=1, train_loss_step=207, train_loss_epoch=318]Epoch 11/60:  17%|█▋        | 10/60 [01:34<07:34,  9.08s/it, v_num=1, train_loss_step=207, train_loss_epoch=318]Epoch 11/60:  18%|█▊        | 11/60 [01:42<07:11,  8.82s/it, v_num=1, train_loss_step=207, train_loss_epoch=318]Epoch 11/60:  18%|█▊        | 11/60 [01:42<07:11,  8.82s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 12/60:  18%|█▊        | 11/60 [01:42<07:11,  8.82s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 12/60:  20%|██        | 12/60 [01:50<06:50,  8.56s/it, v_num=1, train_loss_step=250, train_loss_epoch=317]Epoch 12/60:  20%|██        | 12/60 [01:50<06:50,  8.56s/it, v_num=1, train_loss_step=0.0258, train_loss_epoch=317]Epoch 13/60:  20%|██        | 12/60 [01:50<06:50,  8.56s/it, v_num=1, train_loss_step=0.0258, train_loss_epoch=317]Epoch 13/60:  22%|██▏       | 13/60 [01:59<06:47,  8.66s/it, v_num=1, train_loss_step=0.0258, train_loss_epoch=317]Epoch 13/60:  22%|██▏       | 13/60 [01:59<06:47,  8.66s/it, v_num=1, train_loss_step=270, train_loss_epoch=316]   Epoch 14/60:  22%|██▏       | 13/60 [01:59<06:47,  8.66s/it, v_num=1, train_loss_step=270, train_loss_epoch=316]Epoch 14/60:  23%|██▎       | 14/60 [02:07<06:32,  8.53s/it, v_num=1, train_loss_step=270, train_loss_epoch=316]Epoch 14/60:  23%|██▎       | 14/60 [02:07<06:32,  8.53s/it, v_num=1, train_loss_step=185, train_loss_epoch=315]Epoch 15/60:  23%|██▎       | 14/60 [02:07<06:32,  8.53s/it, v_num=1, train_loss_step=185, train_loss_epoch=315]Epoch 15/60:  25%|██▌       | 15/60 [02:16<06:20,  8.45s/it, v_num=1, train_loss_step=185, train_loss_epoch=315]Epoch 15/60:  25%|██▌       | 15/60 [02:16<06:20,  8.45s/it, v_num=1, train_loss_step=418, train_loss_epoch=315]Epoch 16/60:  25%|██▌       | 15/60 [02:16<06:20,  8.45s/it, v_num=1, train_loss_step=418, train_loss_epoch=315]Epoch 16/60:  27%|██▋       | 16/60 [02:24<06:06,  8.34s/it, v_num=1, train_loss_step=418, train_loss_epoch=315]Epoch 16/60:  27%|██▋       | 16/60 [02:24<06:06,  8.34s/it, v_num=1, train_loss_step=201, train_loss_epoch=314]Epoch 17/60:  27%|██▋       | 16/60 [02:24<06:06,  8.34s/it, v_num=1, train_loss_step=201, train_loss_epoch=314]Epoch 17/60:  28%|██▊       | 17/60 [02:32<06:01,  8.40s/it, v_num=1, train_loss_step=201, train_loss_epoch=314]Epoch 17/60:  28%|██▊       | 17/60 [02:32<06:01,  8.40s/it, v_num=1, train_loss_step=806, train_loss_epoch=314]Epoch 18/60:  28%|██▊       | 17/60 [02:32<06:01,  8.40s/it, v_num=1, train_loss_step=806, train_loss_epoch=314]Epoch 18/60:  30%|███       | 18/60 [02:41<05:54,  8.43s/it, v_num=1, train_loss_step=806, train_loss_epoch=314]Epoch 18/60:  30%|███       | 18/60 [02:41<05:54,  8.43s/it, v_num=1, train_loss_step=472, train_loss_epoch=313]Epoch 19/60:  30%|███       | 18/60 [02:41<05:54,  8.43s/it, v_num=1, train_loss_step=472, train_loss_epoch=313]Epoch 19/60:  32%|███▏      | 19/60 [02:48<05:35,  8.19s/it, v_num=1, train_loss_step=472, train_loss_epoch=313]Epoch 19/60:  32%|███▏      | 19/60 [02:48<05:35,  8.19s/it, v_num=1, train_loss_step=172, train_loss_epoch=313]Epoch 20/60:  32%|███▏      | 19/60 [02:48<05:35,  8.19s/it, v_num=1, train_loss_step=172, train_loss_epoch=313]Epoch 20/60:  33%|███▎      | 20/60 [02:56<05:26,  8.16s/it, v_num=1, train_loss_step=172, train_loss_epoch=313]Epoch 20/60:  33%|███▎      | 20/60 [02:56<05:26,  8.16s/it, v_num=1, train_loss_step=188, train_loss_epoch=312]Epoch 21/60:  33%|███▎      | 20/60 [02:56<05:26,  8.16s/it, v_num=1, train_loss_step=188, train_loss_epoch=312]Epoch 21/60:  35%|███▌      | 21/60 [03:05<05:21,  8.23s/it, v_num=1, train_loss_step=188, train_loss_epoch=312]Epoch 21/60:  35%|███▌      | 21/60 [03:05<05:21,  8.23s/it, v_num=1, train_loss_step=0.182, train_loss_epoch=312]Epoch 22/60:  35%|███▌      | 21/60 [03:05<05:21,  8.23s/it, v_num=1, train_loss_step=0.182, train_loss_epoch=312]Epoch 22/60:  37%|███▋      | 22/60 [03:13<05:10,  8.18s/it, v_num=1, train_loss_step=0.182, train_loss_epoch=312]Epoch 22/60:  37%|███▋      | 22/60 [03:13<05:10,  8.18s/it, v_num=1, train_loss_step=335, train_loss_epoch=311]  Epoch 23/60:  37%|███▋      | 22/60 [03:13<05:10,  8.18s/it, v_num=1, train_loss_step=335, train_loss_epoch=311]Epoch 23/60:  38%|███▊      | 23/60 [03:21<05:05,  8.27s/it, v_num=1, train_loss_step=335, train_loss_epoch=311]Epoch 23/60:  38%|███▊      | 23/60 [03:21<05:05,  8.27s/it, v_num=1, train_loss_step=91.9, train_loss_epoch=311]Epoch 24/60:  38%|███▊      | 23/60 [03:21<05:05,  8.27s/it, v_num=1, train_loss_step=91.9, train_loss_epoch=311]Epoch 24/60:  40%|████      | 24/60 [03:30<04:57,  8.27s/it, v_num=1, train_loss_step=91.9, train_loss_epoch=311]Epoch 24/60:  40%|████      | 24/60 [03:30<04:57,  8.27s/it, v_num=1, train_loss_step=0.242, train_loss_epoch=310]Epoch 25/60:  40%|████      | 24/60 [03:30<04:57,  8.27s/it, v_num=1, train_loss_step=0.242, train_loss_epoch=310]Epoch 25/60:  42%|████▏     | 25/60 [03:38<04:46,  8.19s/it, v_num=1, train_loss_step=0.242, train_loss_epoch=310]Epoch 25/60:  42%|████▏     | 25/60 [03:38<04:46,  8.19s/it, v_num=1, train_loss_step=0.256, train_loss_epoch=310]Epoch 26/60:  42%|████▏     | 25/60 [03:38<04:46,  8.19s/it, v_num=1, train_loss_step=0.256, train_loss_epoch=310]Epoch 26/60:  43%|████▎     | 26/60 [03:46<04:38,  8.18s/it, v_num=1, train_loss_step=0.256, train_loss_epoch=310]Epoch 26/60:  43%|████▎     | 26/60 [03:46<04:38,  8.18s/it, v_num=1, train_loss_step=223, train_loss_epoch=310]  Epoch 27/60:  43%|████▎     | 26/60 [03:46<04:38,  8.18s/it, v_num=1, train_loss_step=223, train_loss_epoch=310]Epoch 27/60:  45%|████▌     | 27/60 [03:54<04:28,  8.14s/it, v_num=1, train_loss_step=223, train_loss_epoch=310]Epoch 27/60:  45%|████▌     | 27/60 [03:54<04:28,  8.14s/it, v_num=1, train_loss_step=147, train_loss_epoch=310]Epoch 28/60:  45%|████▌     | 27/60 [03:54<04:28,  8.14s/it, v_num=1, train_loss_step=147, train_loss_epoch=310]Epoch 28/60:  47%|████▋     | 28/60 [04:02<04:23,  8.22s/it, v_num=1, train_loss_step=147, train_loss_epoch=310]Epoch 28/60:  47%|████▋     | 28/60 [04:02<04:23,  8.22s/it, v_num=1, train_loss_step=491, train_loss_epoch=309]Epoch 29/60:  47%|████▋     | 28/60 [04:02<04:23,  8.22s/it, v_num=1, train_loss_step=491, train_loss_epoch=309]Epoch 29/60:  48%|████▊     | 29/60 [04:10<04:11,  8.10s/it, v_num=1, train_loss_step=491, train_loss_epoch=309]Epoch 29/60:  48%|████▊     | 29/60 [04:10<04:11,  8.10s/it, v_num=1, train_loss_step=544, train_loss_epoch=309]Epoch 30/60:  48%|████▊     | 29/60 [04:10<04:11,  8.10s/it, v_num=1, train_loss_step=544, train_loss_epoch=309]Epoch 30/60:  50%|█████     | 30/60 [04:18<04:03,  8.13s/it, v_num=1, train_loss_step=544, train_loss_epoch=309]Epoch 30/60:  50%|█████     | 30/60 [04:18<04:03,  8.13s/it, v_num=1, train_loss_step=545, train_loss_epoch=308]Epoch 31/60:  50%|█████     | 30/60 [04:18<04:03,  8.13s/it, v_num=1, train_loss_step=545, train_loss_epoch=308]Epoch 31/60:  52%|█████▏    | 31/60 [04:26<03:54,  8.08s/it, v_num=1, train_loss_step=545, train_loss_epoch=308]Epoch 31/60:  52%|█████▏    | 31/60 [04:26<03:54,  8.08s/it, v_num=1, train_loss_step=0.332, train_loss_epoch=308]Epoch 32/60:  52%|█████▏    | 31/60 [04:26<03:54,  8.08s/it, v_num=1, train_loss_step=0.332, train_loss_epoch=308]Epoch 32/60:  53%|█████▎    | 32/60 [04:46<05:20, 11.45s/it, v_num=1, train_loss_step=0.332, train_loss_epoch=308]Epoch 32/60:  53%|█████▎    | 32/60 [04:46<05:20, 11.45s/it, v_num=1, train_loss_step=256, train_loss_epoch=308]  Epoch 33/60:  53%|█████▎    | 32/60 [04:46<05:20, 11.45s/it, v_num=1, train_loss_step=256, train_loss_epoch=308]Epoch 33/60:  55%|█████▌    | 33/60 [05:01<05:40, 12.62s/it, v_num=1, train_loss_step=256, train_loss_epoch=308]Epoch 33/60:  55%|█████▌    | 33/60 [05:01<05:40, 12.62s/it, v_num=1, train_loss_step=268, train_loss_epoch=308]Epoch 34/60:  55%|█████▌    | 33/60 [05:01<05:40, 12.62s/it, v_num=1, train_loss_step=268, train_loss_epoch=308]Epoch 34/60:  57%|█████▋    | 34/60 [05:21<06:24, 14.80s/it, v_num=1, train_loss_step=268, train_loss_epoch=308]Epoch 34/60:  57%|█████▋    | 34/60 [05:21<06:24, 14.80s/it, v_num=1, train_loss_step=477, train_loss_epoch=307]Epoch 35/60:  57%|█████▋    | 34/60 [05:21<06:24, 14.80s/it, v_num=1, train_loss_step=477, train_loss_epoch=307]Epoch 35/60:  58%|█████▊    | 35/60 [05:30<05:29, 13.17s/it, v_num=1, train_loss_step=477, train_loss_epoch=307]Epoch 35/60:  58%|█████▊    | 35/60 [05:30<05:29, 13.17s/it, v_num=1, train_loss_step=463, train_loss_epoch=307]Epoch 36/60:  58%|█████▊    | 35/60 [05:30<05:29, 13.17s/it, v_num=1, train_loss_step=463, train_loss_epoch=307]Epoch 36/60:  60%|██████    | 36/60 [05:38<04:38, 11.62s/it, v_num=1, train_loss_step=463, train_loss_epoch=307]Epoch 36/60:  60%|██████    | 36/60 [05:38<04:38, 11.62s/it, v_num=1, train_loss_step=737, train_loss_epoch=307]Epoch 37/60:  60%|██████    | 36/60 [05:38<04:38, 11.62s/it, v_num=1, train_loss_step=737, train_loss_epoch=307]Epoch 37/60:  62%|██████▏   | 37/60 [05:46<04:01, 10.51s/it, v_num=1, train_loss_step=737, train_loss_epoch=307]Epoch 37/60:  62%|██████▏   | 37/60 [05:46<04:01, 10.51s/it, v_num=1, train_loss_step=0.403, train_loss_epoch=306]Epoch 38/60:  62%|██████▏   | 37/60 [05:46<04:01, 10.51s/it, v_num=1, train_loss_step=0.403, train_loss_epoch=306]Epoch 38/60:  63%|██████▎   | 38/60 [05:54<03:34,  9.75s/it, v_num=1, train_loss_step=0.403, train_loss_epoch=306]Epoch 38/60:  63%|██████▎   | 38/60 [05:54<03:34,  9.75s/it, v_num=1, train_loss_step=424, train_loss_epoch=306]  Epoch 39/60:  63%|██████▎   | 38/60 [05:54<03:34,  9.75s/it, v_num=1, train_loss_step=424, train_loss_epoch=306]Epoch 39/60:  65%|██████▌   | 39/60 [06:02<03:15,  9.33s/it, v_num=1, train_loss_step=424, train_loss_epoch=306]Epoch 39/60:  65%|██████▌   | 39/60 [06:02<03:15,  9.33s/it, v_num=1, train_loss_step=102, train_loss_epoch=306]Epoch 40/60:  65%|██████▌   | 39/60 [06:02<03:15,  9.33s/it, v_num=1, train_loss_step=102, train_loss_epoch=306]Epoch 40/60:  67%|██████▋   | 40/60 [06:10<02:56,  8.81s/it, v_num=1, train_loss_step=102, train_loss_epoch=306]Epoch 40/60:  67%|██████▋   | 40/60 [06:10<02:56,  8.81s/it, v_num=1, train_loss_step=218, train_loss_epoch=305]Epoch 41/60:  67%|██████▋   | 40/60 [06:10<02:56,  8.81s/it, v_num=1, train_loss_step=218, train_loss_epoch=305]Epoch 41/60:  68%|██████▊   | 41/60 [06:18<02:43,  8.63s/it, v_num=1, train_loss_step=218, train_loss_epoch=305]Epoch 41/60:  68%|██████▊   | 41/60 [06:18<02:43,  8.63s/it, v_num=1, train_loss_step=258, train_loss_epoch=305]Epoch 42/60:  68%|██████▊   | 41/60 [06:18<02:43,  8.63s/it, v_num=1, train_loss_step=258, train_loss_epoch=305]Epoch 42/60:  70%|███████   | 42/60 [06:26<02:32,  8.45s/it, v_num=1, train_loss_step=258, train_loss_epoch=305]Epoch 42/60:  70%|███████   | 42/60 [06:26<02:32,  8.45s/it, v_num=1, train_loss_step=197, train_loss_epoch=305]Epoch 43/60:  70%|███████   | 42/60 [06:26<02:32,  8.45s/it, v_num=1, train_loss_step=197, train_loss_epoch=305]Epoch 43/60:  72%|███████▏  | 43/60 [06:35<02:23,  8.44s/it, v_num=1, train_loss_step=197, train_loss_epoch=305]Epoch 43/60:  72%|███████▏  | 43/60 [06:35<02:23,  8.44s/it, v_num=1, train_loss_step=205, train_loss_epoch=305]Epoch 44/60:  72%|███████▏  | 43/60 [06:35<02:23,  8.44s/it, v_num=1, train_loss_step=205, train_loss_epoch=305]Epoch 44/60:  73%|███████▎  | 44/60 [06:43<02:13,  8.34s/it, v_num=1, train_loss_step=205, train_loss_epoch=305]Epoch 44/60:  73%|███████▎  | 44/60 [06:43<02:13,  8.34s/it, v_num=1, train_loss_step=327, train_loss_epoch=304]Epoch 45/60:  73%|███████▎  | 44/60 [06:43<02:13,  8.34s/it, v_num=1, train_loss_step=327, train_loss_epoch=304]Epoch 45/60:  75%|███████▌  | 45/60 [06:51<02:02,  8.18s/it, v_num=1, train_loss_step=327, train_loss_epoch=304]Epoch 45/60:  75%|███████▌  | 45/60 [06:51<02:02,  8.18s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=304]Epoch 46/60:  75%|███████▌  | 45/60 [06:51<02:02,  8.18s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=304]Epoch 46/60:  77%|███████▋  | 46/60 [07:03<02:13,  9.56s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=304]Epoch 46/60:  77%|███████▋  | 46/60 [07:03<02:13,  9.56s/it, v_num=1, train_loss_step=537, train_loss_epoch=304]  Epoch 47/60:  77%|███████▋  | 46/60 [07:03<02:13,  9.56s/it, v_num=1, train_loss_step=537, train_loss_epoch=304]Epoch 47/60:  78%|███████▊  | 47/60 [07:11<01:57,  9.07s/it, v_num=1, train_loss_step=537, train_loss_epoch=304]Epoch 47/60:  78%|███████▊  | 47/60 [07:11<01:57,  9.07s/it, v_num=1, train_loss_step=0.454, train_loss_epoch=304]Epoch 48/60:  78%|███████▊  | 47/60 [07:11<01:57,  9.07s/it, v_num=1, train_loss_step=0.454, train_loss_epoch=304]Epoch 48/60:  80%|████████  | 48/60 [07:19<01:43,  8.62s/it, v_num=1, train_loss_step=0.454, train_loss_epoch=304]Epoch 48/60:  80%|████████  | 48/60 [07:19<01:43,  8.62s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=303]Epoch 49/60:  80%|████████  | 48/60 [07:19<01:43,  8.62s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=303]Epoch 49/60:  82%|████████▏ | 49/60 [07:27<01:32,  8.44s/it, v_num=1, train_loss_step=0.447, train_loss_epoch=303]Epoch 49/60:  82%|████████▏ | 49/60 [07:27<01:32,  8.44s/it, v_num=1, train_loss_step=915, train_loss_epoch=303]  Epoch 50/60:  82%|████████▏ | 49/60 [07:27<01:32,  8.44s/it, v_num=1, train_loss_step=915, train_loss_epoch=303]Epoch 50/60:  83%|████████▎ | 50/60 [07:35<01:23,  8.32s/it, v_num=1, train_loss_step=915, train_loss_epoch=303]Epoch 50/60:  83%|████████▎ | 50/60 [07:35<01:23,  8.32s/it, v_num=1, train_loss_step=205, train_loss_epoch=303]Epoch 51/60:  83%|████████▎ | 50/60 [07:35<01:23,  8.32s/it, v_num=1, train_loss_step=205, train_loss_epoch=303]Epoch 51/60:  85%|████████▌ | 51/60 [07:43<01:13,  8.19s/it, v_num=1, train_loss_step=205, train_loss_epoch=303]Epoch 51/60:  85%|████████▌ | 51/60 [07:43<01:13,  8.19s/it, v_num=1, train_loss_step=1.32e+3, train_loss_epoch=302]Epoch 52/60:  85%|████████▌ | 51/60 [07:43<01:13,  8.19s/it, v_num=1, train_loss_step=1.32e+3, train_loss_epoch=302]Epoch 52/60:  87%|████████▋ | 52/60 [07:51<01:05,  8.13s/it, v_num=1, train_loss_step=1.32e+3, train_loss_epoch=302]Epoch 52/60:  87%|████████▋ | 52/60 [07:51<01:05,  8.13s/it, v_num=1, train_loss_step=0.46, train_loss_epoch=303]   Epoch 53/60:  87%|████████▋ | 52/60 [07:51<01:05,  8.13s/it, v_num=1, train_loss_step=0.46, train_loss_epoch=303]Epoch 53/60:  88%|████████▊ | 53/60 [07:59<00:56,  8.09s/it, v_num=1, train_loss_step=0.46, train_loss_epoch=303]Epoch 53/60:  88%|████████▊ | 53/60 [07:59<00:56,  8.09s/it, v_num=1, train_loss_step=0.451, train_loss_epoch=302]Epoch 54/60:  88%|████████▊ | 53/60 [07:59<00:56,  8.09s/it, v_num=1, train_loss_step=0.451, train_loss_epoch=302]Epoch 54/60:  90%|█████████ | 54/60 [08:07<00:48,  8.08s/it, v_num=1, train_loss_step=0.451, train_loss_epoch=302]Epoch 54/60:  90%|█████████ | 54/60 [08:07<00:48,  8.08s/it, v_num=1, train_loss_step=1.34e+3, train_loss_epoch=302]Epoch 55/60:  90%|█████████ | 54/60 [08:07<00:48,  8.08s/it, v_num=1, train_loss_step=1.34e+3, train_loss_epoch=302]Epoch 55/60:  92%|█████████▏| 55/60 [08:15<00:40,  8.12s/it, v_num=1, train_loss_step=1.34e+3, train_loss_epoch=302]Epoch 55/60:  92%|█████████▏| 55/60 [08:15<00:40,  8.12s/it, v_num=1, train_loss_step=706, train_loss_epoch=302]    Epoch 56/60:  92%|█████████▏| 55/60 [08:15<00:40,  8.12s/it, v_num=1, train_loss_step=706, train_loss_epoch=302]Epoch 56/60:  93%|█████████▎| 56/60 [08:23<00:32,  8.06s/it, v_num=1, train_loss_step=706, train_loss_epoch=302]Epoch 56/60:  93%|█████████▎| 56/60 [08:23<00:32,  8.06s/it, v_num=1, train_loss_step=235, train_loss_epoch=301]Epoch 57/60:  93%|█████████▎| 56/60 [08:23<00:32,  8.06s/it, v_num=1, train_loss_step=235, train_loss_epoch=301]Epoch 57/60:  95%|█████████▌| 57/60 [08:31<00:24,  8.17s/it, v_num=1, train_loss_step=235, train_loss_epoch=301]Epoch 57/60:  95%|█████████▌| 57/60 [08:31<00:24,  8.17s/it, v_num=1, train_loss_step=205, train_loss_epoch=301]Epoch 58/60:  95%|█████████▌| 57/60 [08:31<00:24,  8.17s/it, v_num=1, train_loss_step=205, train_loss_epoch=301]Epoch 58/60:  97%|█████████▋| 58/60 [08:39<00:16,  8.03s/it, v_num=1, train_loss_step=205, train_loss_epoch=301]Epoch 58/60:  97%|█████████▋| 58/60 [08:39<00:16,  8.03s/it, v_num=1, train_loss_step=0.44, train_loss_epoch=301]Epoch 59/60:  97%|█████████▋| 58/60 [08:39<00:16,  8.03s/it, v_num=1, train_loss_step=0.44, train_loss_epoch=301]Epoch 59/60:  98%|█████████▊| 59/60 [08:47<00:08,  8.02s/it, v_num=1, train_loss_step=0.44, train_loss_epoch=301]Epoch 59/60:  98%|█████████▊| 59/60 [08:47<00:08,  8.02s/it, v_num=1, train_loss_step=256, train_loss_epoch=300] Epoch 60/60:  98%|█████████▊| 59/60 [08:47<00:08,  8.02s/it, v_num=1, train_loss_step=256, train_loss_epoch=300]Epoch 60/60: 100%|██████████| 60/60 [08:55<00:00,  8.06s/it, v_num=1, train_loss_step=256, train_loss_epoch=300]Epoch 60/60: 100%|██████████| 60/60 [08:55<00:00,  8.06s/it, v_num=1, train_loss_step=1.02e+3, train_loss_epoch=300]`Trainer.fit` stopped: `max_epochs=60` reached.
Epoch 60/60: 100%|██████████| 60/60 [08:55<00:00,  8.93s/it, v_num=1, train_loss_step=1.02e+3, train_loss_epoch=300]2025-12-20 14:37:12,058 [INFO] Compare airspace scores after denoising
2025-12-20 14:37:12,989 [INFO] Writing summary of results to file
2025-12-20 14:37:12,991 [INFO] Plot scatter of correlation faceted by model
/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py:177: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  donor_corrs = df_melted.groupby(["Model", "donor_id"]).apply(

Summary results saved to: airspace/agtr1_model_summary.txt
Saved melted correlation data to: airspace/pericytes_airspace_denoising.tsv
Traceback (most recent call last):
  File "/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py", line 258, in <module>
    main()
  File "/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py", line 251, in main
    plot_corr(adata, pericyte_mask, airspace_dir / "pericytes_airspace_denoising")
  File "/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py", line 177, in plot_corr
    donor_corrs = df_melted.groupby(["Model", "donor_id"]).apply(
  File "/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1825, in apply
    result = self._python_apply_general(f, self._selected_obj)
  File "/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1886, in _python_apply_general
    values, mutated = self._grouper.apply_groupwise(f, data, self.axis)
  File "/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/pandas/core/groupby/ops.py", line 919, in apply_groupwise
    res = f(group)
  File "/ocean/projects/bio250020p/kbenjamin/projects/angiotensinII_lung/localization/airspace_analysis/_m/../_h/02.qc_airspace.py", line 178, in <lambda>
    lambda g: pd.Series(pearsonr(g["AGTR1_scvi"], g["airspace_score"]),
  File "/ocean/projects/bio250020p/shared/opt/env/scRNA_env/lib/python3.10/site-packages/scipy/stats/_stats_py.py", line 4552, in pearsonr
    raise ValueError('`x` and `y` must have length at least 2.')
ValueError: `x` and `y` must have length at least 2.
2025-12-20 14:37:58 - Error: Python execution failed
